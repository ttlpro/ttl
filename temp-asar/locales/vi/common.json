jY291bnRzIChcbiAgICAgICAgICAgICAgICAgICAgaWQsIHVzZXJuYW1lLCBzZXNzaW9uSWQsIHBhc3N3b3JkLCBlbWFpbCwgZW1haWxQYXNzd29yZCwgY29va2llLFxuICAgICAgICAgICAgICAgICAgICBmb2xkZXJJZCwgc3RhdHVzLCBsYXN0QWN0aXZlLCBsYXN0VXNlZCwgY3VycmVudFJvb21zLCBhdmF0YXJUaHVtYiwgcm9vbVVzZXJuYW1lLCBhY3RpdmVSb29tcyxcbiAgICAgICAgICAgICAgICAgICAgdmlld2VyQ291bnQsIGZvbGxvd0NvdW50LCBzaGFyZUNvdW50LCB0b3RhbFZpZXdzLCB0b3RhbFNoYXJlcywgdG90YWxGb2xsb3dzLCBpc0xpdmUsXG4gICAgICAgICAgICAgICAgICAgIHByb3h5SWQsIG1ldGFkYXRhLCBub3RlcywgY3JlYXRlZEF0LCB1cGRhdGVkQXRcbiAgICAgICAgICAgICAgICApIFZBTFVFUyAoPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPylcbiAgICAgICAgICAgIGApO1xuXG4gICAgICAgICAgICBzdG10LnJ1bihcbiAgICAgICAgICAgICAgICBhY2NvdW50SWQsXG4gICAgICAgICAgICAgICAgdXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgYWNjb3VudERhdGEuc2Vzc2lvbklkIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgYWNjb3VudERhdGEucGFzc3dvcmQgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBhY2NvdW50RGF0YS5lbWFpbCB8fCBudWxsLFxuICAgICAgICAgICAgICAgIGFjY291bnREYXRhLmVtYWlsUGFzc3dvcmQgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBhY2NvdW50RGF0YS5jb29raWUgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBhY2NvdW50RGF0YS5mb2xkZXJJZCB8fCBudWxsLFxuICAgICAgICAgICAgICAgIGFjY291bnREYXRhLnN0YXR1cyB8fCAnYWN0aXZlJyxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgIGFjY291bnREYXRhLmxhc3RVc2VkIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgYWNjb3VudERhdGEuY3VycmVudFJvb21zIHx8IDAsXG4gICAgICAgICAgICAgICAgYWNjb3VudERhdGEuYXZhdGFyVGh1bWIgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBhY2NvdW50RGF0YS5yb29tVXNlcm5hbWUgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShhY2NvdW50RGF0YS5hY3RpdmVSb29tcyB8fCBbXSksXG4gICAgICAgICAgICAgICAgMCwgMCwgMCwgMCwgMCwgMCwgMCxcbiAgICAgICAgICAgICAgICBhY2NvdW50RGF0YS5wcm94eUlkIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgbWV0YWRhdGFKc29uLFxuICAgICAgICAgICAgICAgIGFjY291bnREYXRhLm5vdGVzIHx8ICcnLFxuICAgICAgICAgICAgICAgIG5vdyxcbiAgICAgICAgICAgICAgICBub3dcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNvbnN0IG5ld0FjY291bnQgPSB7XG4gICAgICAgICAgICAgICAgaWQ6IGFjY291bnRJZCxcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgc2Vzc2lvbklkOiBhY2NvdW50RGF0YS5zZXNzaW9uSWQgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogYWNjb3VudERhdGEucGFzc3dvcmQgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBlbWFpbDogYWNjb3VudERhdGEuZW1haWwgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBlbWFpbFBhc3N3b3JkOiBhY2NvdW50RGF0YS5lbWFpbFBhc3N3b3JkIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgY29va2llOiBhY2NvdW50RGF0YS5jb29raWUgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBmb2xkZXJJZDogYWNjb3VudERhdGEuZm9sZGVySWQgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGFjY291bnREYXRhLnN0YXR1cyB8fCAnYWN0aXZlJyxcbiAgICAgICAgICAgICAgICBsYXN0QWN0aXZlOiBudWxsLFxuICAgICAgICAgICAgICAgIGxhc3RVc2VkOiBhY2NvdW50RGF0YS5sYXN0VXNlZCB8fCBudWxsLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRSb29tczogYWNjb3VudERhdGEuY3VycmVudFJvb21zIHx8IDAsXG4gICAgICAgICAgICAgICAgYXZhdGFyVGh1bWI6IGFjY291bnREYXRhLmF2YXRhclRodW1iIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgcm9vbVVzZXJuYW1lOiBhY2NvdW50RGF0YS5yb29tVXNlcm5hbWUgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBhY3RpdmVSb29tczogYWNjb3VudERhdGEuYWN0aXZlUm9vbXMgfHwgW10sXG4gICAgICAgICAgICAgICAgdmlld2VyQ291bnQ6IDAsXG4gICAgICAgICAgICAgICAgZm9sbG93Q291bnQ6IDAsXG4gICAgICAgICAgICAgICAgc2hhcmVDb3VudDogMCxcbiAgICAgICAgICAgICAgICB0b3RhbFZpZXdzOiAwLFxuICAgICAgICAgICAgICAgIHRvdGFsU2hhcmVzOiAwLFxuICAgICAgICAgICAgICAgIHRvdGFsRm9sbG93czogMCxcbiAgICAgICAgICAgICAgICBpc0xpdmU6IDAsXG4gICAgICAgICAgICAgICAgcHJveHlJZDogYWNjb3VudERhdGEucHJveHlJZCB8fCBudWxsLFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiBtZXRhZGF0YUpzb24sXG4gICAgICAgICAgICAgICAgbm90ZXM6IGFjY291bnREYXRhLm5vdGVzIHx8ICcnLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogbm93LFxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogbm93XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBsb2coYOKchSBBZGRlZCBhY2NvdW50OiAke3VzZXJuYW1lfWApO1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgYWNjb3VudDogdGhpcy5zZXJpYWxpemVGb3JJUEMobmV3QWNjb3VudCkgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBlcnJvcign4p2MIEVycm9yIGFkZGluZyBhY2NvdW50OicsIGVycik7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVyci5tZXNzYWdlIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBYw7NhIGFjY291bnRcbiAgICAgKi9cbiAgICBhc3luYyBkZWxldGVBY2NvdW50KGFjY291bnRJZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gWMOzYSBhY2NvdW50IGto4buPaSByb29tcyB0csaw4bubY1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jbGVhckFjY291bnRSb29tcyhhY2NvdW50SWQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBYw7NhIGFjY291bnRcbiAgICAgICAgICAgIGNvbnN0IHN0bXQgPSB0aGlzLmRiLnByZXBhcmUoYERFTEVURSBGUk9NIGFjY291bnRzIFdIRVJFIGlkID0gP2ApO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3RtdC5ydW4oYWNjb3VudElkKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHJlc3VsdC5jaGFuZ2VzID4gMCkge1xuICAgICAgICAgICAgICAgIGxvZyhg4pyFIERlbGV0ZWQgYWNjb3VudCAke2FjY291bnRJZH1gKTtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGFjY291bnQ6JywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBD4bqtcCBuaOG6rXQgYWNjb3VudFxuICAgICAqL1xuICAgIGFzeW5jIHVwZGF0ZUFjY291bnQoaWQsIHVwZGF0ZXMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3Qgc2V0RmllbGRzID0gW107XG4gICAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBbXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXModXBkYXRlcykpIHtcbiAgICAgICAgICAgICAgICAvLyBC4buPIHF1YSBjw6FjIGdpw6EgdHLhu4sgdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nKGDimqDvuI8gQuG7jyBxdWEgdHLGsOG7nW5nICR7a2V5fSB24bubaSBnacOhIHRy4buLIHVuZGVmaW5lZGApO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGtleSA9PT0gJ2xhc3RVcGRhdGVkJykge1xuICAgICAgICAgICAgICAgICAgICBsb2coJ+KaoO+4jyBD4buZdCBsYXN0VXBkYXRlZCDEkcaw4bujYyB0aGF5IMSR4buVaSB0aMOgbmggdXBkYXRlZEF0Jyk7XG4gICAgICAgICAgICAgICAgICAgIHNldEZpZWxkcy5wdXNoKGB1cGRhdGVkQXQgPSA/YCk7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKFN0cmluZyh2YWx1ZSkgfHwgbm93KTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChrZXkgPT09ICdtZXRhZGF0YScpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0RmllbGRzLnB1c2goYCR7a2V5fSA9ID9gKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzLnB1c2goSlNPTi5zdHJpbmdpZnkodmFsdWUgfHwge30pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKCfinYwgTOG7l2kga2hpIGNodXnhu4NuIMSR4buVaSBtZXRhZGF0YSB0aMOgbmggSlNPTjonLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKCd7fScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChrZXkgPT09ICdsYXN0QWN0aXZlJyB8fCBrZXkgPT09ICdzdGFydGVkQXQnIHx8IGtleSA9PT0gJ2VuZGVkQXQnIHx8IGtleSA9PT0gJ2xhc3RUaW1lQ2hlY2tWaWV3ZXJzJyB8fCBrZXkgPT09ICdzdG9wcGVkQXQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldEZpZWxkcy5wdXNoKGAke2tleX0gPSA/YCk7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKHZhbHVlID8gU3RyaW5nKHZhbHVlKSA6IG51bGwpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSAnYXZhdGFyVGh1bWInIHx8IGtleSA9PT0gJ3Jvb21Vc2VybmFtZScpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gxJDhuqNtIGLhuqNvIGPDoWMgdHLGsOG7nW5nIHN0cmluZyBsdcO0biBsw6Agc3RyaW5nIGhv4bq3YyBudWxsXG4gICAgICAgICAgICAgICAgICAgIHNldEZpZWxkcy5wdXNoKGAke2tleX0gPSA/YCk7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB1bmRlZmluZWQgPyBTdHJpbmcodmFsdWUpIDogbnVsbCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChrZXkgPT09ICdjdXJyZW50Um9vbXMnIHx8IGtleSA9PT0gJ3ZpZXdlckNvdW50JyB8fCBrZXkgPT09ICdmb2xsb3dDb3VudCcgfHwga2V5ID09PSAnc2hhcmVDb3VudCcgfHwga2V5ID09PSAndG90YWxWaWV3cycgfHwga2V5ID09PSAndG90YWxTaGFyZXMnIHx8IGtleSA9PT0gJ3RvdGFsRm9sbG93cycgfHwga2V5ID09PSAnaXNMaXZlJykge1xuICAgICAgICAgICAgICAgICAgICAvLyDEkOG6o20gYuG6o28gY8OhYyB0csaw4budbmcgc+G7kSBsdcO0biBsw6Agc+G7kVxuICAgICAgICAgICAgICAgICAgICBzZXRGaWVsZHMucHVzaChgJHtrZXl9ID0gP2ApO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaChOdW1iZXIodmFsdWUpIHx8IDApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSAnYWN0aXZlUm9vbXMnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIMSQ4bqjbSBi4bqjbyBhY3RpdmVSb29tcyBsdcO0biBsw6AgSlNPTiBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgc2V0RmllbGRzLnB1c2goYCR7a2V5fSA9ID9gKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB4ZW0gxJHDoyBsw6AgSlNPTiBo4bujcCBs4buHIGNoxrBhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSlNPTi5wYXJzZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzLnB1c2godmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKCfinYwgTOG7l2kga2hpIHBhcnNlIGFjdGl2ZVJvb21zIHN0cmluZzonLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaCgnW10nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzLnB1c2goSlNPTi5zdHJpbmdpZnkodmFsdWUpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKCdbXScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ8OhYyB0csaw4budbmcga2jDoWNcbiAgICAgICAgICAgICAgICAgICAgc2V0RmllbGRzLnB1c2goYCR7a2V5fSA9ID9gKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIMSQ4bqjbSBi4bqjbyBnacOhIHRy4buLIGzDoCBraeG7g3UgU1FMaXRlIGjhu6NwIGzhu4dcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoYOKdjCBM4buXaSBraGkgY2h1eeG7g24gxJHhu5VpICR7a2V5fSB0aMOgbmggSlNPTjpgLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaChTdHJpbmcodmFsdWUpIHx8IG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzLnB1c2godmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoc2V0RmllbGRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCF1cGRhdGVzLmhhc093blByb3BlcnR5KCd1cGRhdGVkQXQnKSAmJiAhdXBkYXRlcy5oYXNPd25Qcm9wZXJ0eSgnbGFzdFVwZGF0ZWQnKSkge1xuICAgICAgICAgICAgICAgIHNldEZpZWxkcy5wdXNoKCd1cGRhdGVkQXQgPSA/Jyk7XG4gICAgICAgICAgICAgICAgdmFsdWVzLnB1c2gobm93KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFsdWVzLnB1c2goaWQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBzcWwgPSBgVVBEQVRFIGFjY291bnRzIFNFVCAke3NldEZpZWxkcy5qb2luKCcsICcpfSBXSEVSRSBpZCA9ID9gO1xuICAgICAgICAgICAgY29uc3Qgc3RtdCA9IHRoaXMuZGIucHJlcGFyZShzcWwpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBsb2coYPCflIQgVXBkYXRpbmcgYWNjb3VudCAke2lkfSB3aXRoIGZpZWxkczogJHtzZXRGaWVsZHMuam9pbignLCAnKX1gKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHN0bXQucnVuKC4uLnZhbHVlcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChyZXN1bHQuY2hhbmdlcyA+IDApIHtcbiAgICAgICAgICAgICAgICBsb2coYOKchSBVcGRhdGVkIGFjY291bnQgJHtpZH1gKTtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FjY291bnQgbm90IGZvdW5kJyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGVycm9yKCfinYwgRXJyb3IgdXBkYXRpbmcgYWNjb3VudDonLCBlcnIpO1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnIubWVzc2FnZSB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ+G6rXAgbmjhuq10IHN0YXRzIGPhu6dhIGFjY291bnRcbiAgICAgKi9cbiAgICBhc3luYyB1cGRhdGVBY2NvdW50U3RhdHMoYWNjb3VudElkLCBzdGF0cykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgc3RtdCA9IHRoaXMuZGIucHJlcGFyZShgXG4gICAgICAgICAgICAgICAgVVBEQVRFIGFjY291bnRzIFNFVCBcbiAgICAgICAgICAgICAgICAgICAgdmlld2VyQ291bnQgPSA/LFxuICAgICAgICAgICAgICAgICAgICBmb2xsb3dDb3VudCA9ID8sXG4gICAgICAgICAgICAgICAgICAgIHNoYXJlQ291bnQgPSA/LFxuICAgICAgICAgICAgICAgICAgICB0b3RhbFZpZXdzID0gPyxcbiAgICAgICAgICAgICAgICAgICAgdG90YWxTaGFyZXMgPSA/LFxuICAgICAgICAgICAgICAgICAgICB0b3RhbEZvbGxvd3MgPSA/LFxuICAgICAgICAgICAgICAgICAgICBpc0xpdmUgPSA/LFxuICAgICAgICAgICAgICAgICAgICBsYXN0QWN0aXZlID0gPyxcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlUm9vbXMgPSA/LFxuICAgICAgICAgICAgICAgICAgICB1cGRhdGVkQXQgPSA/XG4gICAgICAgICAgICAgICAgV0hFUkUgaWQgPSA/XG4gICAgICAgICAgICBgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3RtdC5ydW4oXG4gICAgICAgICAgICAgICAgc3RhdHMudmlld2VyQ291bnQgfHwgMCxcbiAgICAgICAgICAgICAgICBzdGF0cy5mb2xsb3dDb3VudCB8fCAwLFxuICAgICAgICAgICAgICAgIHN0YXRzLnNoYXJlQ291bnQgfHwgMCxcbiAgICAgICAgICAgICAgICBzdGF0cy50b3RhbFZpZXdzIHx8IDAsXG4gICAgICAgICAgICAgICAgc3RhdHMudG90YWxTaGFyZXMgfHwgMCxcbiAgICAgICAgICAgICAgICBzdGF0cy50b3RhbEZvbGxvd3MgfHwgMCxcbiAgICAgICAgICAgICAgICBzdGF0cy5pc0xpdmUgPyAxIDogMCxcbiAgICAgICAgICAgICAgICBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgc3RhdHMuYWN0aXZlUm9vbXMgPyBKU09OLnN0cmluZ2lmeShzdGF0cy5hY3RpdmVSb29tcykgOiAnW10nLFxuICAgICAgICAgICAgICAgIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICBhY2NvdW50SWRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQuY2hhbmdlcyA+IDA7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBlcnJvcignRXJyb3IgdXBkYXRpbmcgYWNjb3VudCBzdGF0czonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBYw7NhIHThuqV0IGPhuqMgcm9vbSByZWxhdGlvbnNoaXBzIGPhu6dhIGFjY291bnRcbiAgICAgKi9cbiAgICBhc3luYyBjbGVhckFjY291bnRSb29tcyhhY2NvdW50SWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHN0bXQgPSB0aGlzLmRiLnByZXBhcmUoYFxuICAgICAgICAgICAgICAgIERFTEVURSBGUk9NIGFjY291bnRfcm9vbXMgV0hFUkUgYWNjb3VudElkID0gP1xuICAgICAgICAgICAgYCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ+G6rXAgbmjhuq10IHRyxrDhu51uZyBhY3RpdmVSb29tcyB2w6AgY3VycmVudFJvb21zIHRyb25nIGLhuqNuZyBhY2NvdW50c1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlU3RtdCA9IHRoaXMuZGIucHJlcGFyZShgXG4gICAgICAgICAgICAgICAgVVBEQVRFIGFjY291bnRzIFxuICAgICAgICAgICAgICAgIFNFVCBhY3RpdmVSb29tcyA9ICdbXScsXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSb29tcyA9IDAsXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRBdCA9ID9cbiAgICAgICAgICAgICAgICBXSEVSRSBpZCA9ID9cbiAgICAgICAgICAgIGApO1xuICAgICAgICAgICAgdXBkYXRlU3RtdC5ydW4obm93LCBhY2NvdW50SWQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzdG10LnJ1bihhY2NvdW50SWQpO1xuICAgICAgICAgICAgbG9nKGDinIUgQ2xlYXJlZCAke3Jlc3VsdC5jaGFuZ2VzfSByb29tIHJlbGF0aW9uc2hpcHMgZm9yIGFjY291bnQgJHthY2NvdW50SWR9YCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQuY2hhbmdlcztcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGVycm9yKCdFcnJvciBjbGVhcmluZyBhY2NvdW50IHJvb21zOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTOG6pXkgYWN0aXZlIHJvb21zIGPhu6dhIGFjY291bnQgdOG7qyB0csaw4budbmcgYWN0aXZlUm9vbXNcbiAgICAgKi9cbiAgICBhc3luYyBnZXRBY2NvdW50QWN0aXZlUm9vbXMoYWNjb3VudElkKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBUaOG7rSDEkeG6p3UgdGnDqm4gdOG7qyB0csaw4budbmcgYWN0aXZlUm9vbXNcbiAgICAgICAgICAgIGNvbnN0IGFjY291bnRTdG10ID0gdGhpcy5kYi5wcmVwYXJlKGBcbiAgICAgICAgICAgICAgICBTRUxFQ1QgYWN0aXZlUm9vbXMgRlJPTSBhY2NvdW50cyBXSEVSRSBpZCA9ID9cbiAgICAgICAgICAgIGApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBhY2NvdW50RGF0YSA9IGFjY291bnRTdG10LmdldChhY2NvdW50SWQpO1xuICAgICAgICAgICAgaWYgKGFjY291bnREYXRhICYmIGFjY291bnREYXRhLmFjdGl2ZVJvb21zKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWN0aXZlUm9vbXMgPSBKU09OLnBhcnNlKGFjY291bnREYXRhLmFjdGl2ZVJvb21zKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYWN0aXZlUm9vbXMpICYmIGFjdGl2ZVJvb21zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE7hur91IGPDsyBk4buvIGxp4buHdSB04burIGFjdGl2ZVJvb21zLCB0cuG6oyB24buBXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZXJpYWxpemVGb3JJUEMoYWN0aXZlUm9vbXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICBlcnJvcignRXJyb3IgcGFyc2luZyBhY3RpdmVSb29tcyBKU09OOicsIGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRmFsbCBiYWNrIHRvIHJlbGF0aW9uc2hpcCB0YWJsZVxuICAgICAgICAgICAgY29uc3Qgc3RtdCA9IHRoaXMuZGIucHJlcGFyZShgXG4gICAgICAgICAgICAgICAgU0VMRUNUIHIuKiBGUk9NIHJvb21zIHJcbiAgICAgICAgICAgICAgICBJTk5FUiBKT0lOIGFjY291bnRfcm9vbXMgYXIgT04gci51aWQgPSBhci5yb29tSWRcbiAgICAgICAgICAgICAgICBXSEVSRSBhci5hY2NvdW50SWQgPSA/XG4gICAgICAgICAgICAgICAgT1JERVIgQlkgci5jcmVhdGVkQXQgREVTQ1xuICAgICAgICAgICAgYCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHJvb21zID0gc3RtdC5hbGwoYWNjb3VudElkKS5tYXAocm9vbSA9PiAoe1xuICAgICAgICAgICAgICAgIC4uLnJvb20sXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiByb29tLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHJvb20udXBkYXRlZEF0XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEPhuq1wIG5o4bqtdCBhY3RpdmVSb29tcyB0cm9uZyBhY2NvdW50XG4gICAgICAgICAgICBpZiAocm9vbXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZVN0bXQgPSB0aGlzLmRiLnByZXBhcmUoYFxuICAgICAgICAgICAgICAgICAgICBVUERBVEUgYWNjb3VudHMgU0VUIGFjdGl2ZVJvb21zID0gPyBXSEVSRSBpZCA9ID9cbiAgICAgICAgICAgICAgICBgKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVTdG10LnJ1bihKU09OLnN0cmluZ2lmeShyb29tcyksIGFjY291bnRJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlcmlhbGl6ZUZvcklQQyhyb29tcyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBlcnJvcignRXJyb3IgZ2V0dGluZyBhY2NvdW50IGFjdGl2ZSByb29tczonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbXBvcnQgYWNjb3VudHMgdOG7qyB0ZXh0ICht4buXaSBkw7JuZyBt4buZdCBhY2NvdW50KVxuICAgICAqL1xuICAgIGFzeW5jIGltcG9ydEFjY291bnRzRnJvbVRleHQodGV4dCwgZm9sZGVySWQgPSBudWxsKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsb2coYPCfk6UgSW1wb3J0aW5nIGFjY291bnRzIGZyb20gdGV4dC4gTGVuZ3RoOiAke3RleHQubGVuZ3RofSwgRm9sZGVySWQ6ICR7Zm9sZGVySWQgfHwgJ251bGwnfSwgVHlwZTogJHt0eXBlb2YgZm9sZGVySWR9YCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFjhu60gbMO9IGZvbGRlcklkIG7hur91IGzDoCAnZGVmYXVsdCcgaG/hurdjIG51bGxcbiAgICAgICAgICAgIGlmICghZm9sZGVySWQgfHwgZm9sZGVySWQgPT09ICdkZWZhdWx0Jykge1xuICAgICAgICAgICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIGZvbGRlciAnZGVmYXVsdCcgY8OzIHThu5NuIHThuqFpIGtow7RuZ1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoZWNrRm9sZGVyID0gdGhpcy5kYi5wcmVwYXJlKGBcbiAgICAgICAgICAgICAgICAgICAgU0VMRUNUIGlkIEZST00gZm9sZGVycyBXSEVSRSB0eXBlID0gJ2FjY291bnRzJyBBTkQgKGlkID0gJ2RlZmF1bHQnIE9SIG5hbWUgPSAnRGVmYXVsdCcpXG4gICAgICAgICAgICAgICAgYCkuZ2V0KCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKCFjaGVja0ZvbGRlcikge1xuICAgICAgICAgICAgICAgICAgICBsb2coJ/Cfk4EgQ3JlYXRpbmcgZGVmYXVsdCBhY2NvdW50cyBmb2xkZXInKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gVOG6oW8gZm9sZGVyIG3hurdjIMSR4buLbmggbuG6v3UgY2jGsGEgY8OzXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRGb2xkZXJJZCA9ICdkZWZhdWx0JztcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmb2xkZXJTdG10ID0gdGhpcy5kYi5wcmVwYXJlKGBcbiAgICAgICAgICAgICAgICAgICAgICAgIElOU0VSVCBJTlRPIGZvbGRlcnMgKGlkLCBuYW1lLCB0eXBlLCBjb2xvciwgZGVzY3JpcHRpb24sIGNyZWF0ZWRBdCwgdXBkYXRlZEF0KVxuICAgICAgICAgICAgICAgICAgICAgICAgVkFMVUVTICg/LCA/LCA/LCA/LCA/LCA/LCA/KVxuICAgICAgICAgICAgICAgICAgICBgKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGZvbGRlclN0bXQucnVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdEZvbGRlcklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ0RlZmF1bHQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2FjY291bnRzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICcjM0I4MkY2JywgLy8gQmx1ZSBjb2xvclxuICAgICAgICAgICAgICAgICAgICAgICAgJ0RlZmF1bHQgZm9sZGVyIGZvciBhY2NvdW50cycsXG4gICAgICAgICAgICAgICAgICAgICAgICBub3csXG4gICAgICAgICAgICAgICAgICAgICAgICBub3dcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGxvZygn4pyFIENyZWF0ZWQgZGVmYXVsdCBhY2NvdW50cyBmb2xkZXInKTtcbiAgICAgICAgICAgICAgICAgICAgZm9sZGVySWQgPSBkZWZhdWx0Rm9sZGVySWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9sZGVySWQgPSBjaGVja0ZvbGRlci5pZDtcbiAgICAgICAgICAgICAgICAgICAgbG9nKGDwn5OBIFVzaW5nIGV4aXN0aW5nIGRlZmF1bHQgZm9sZGVyOiAke2ZvbGRlcklkfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gS2nhu4NtIHRyYSB4ZW0gZm9sZGVyIMSRw6MgY2jhu41uIGPDsyB04buTbiB04bqhaSBraMO0bmdcbiAgICAgICAgICAgICAgICBjb25zdCBjaGVja0ZvbGRlciA9IHRoaXMuZGIucHJlcGFyZShgXG4gICAgICAgICAgICAgICAgICAgIFNFTEVDVCBpZCBGUk9NIGZvbGRlcnMgV0hFUkUgaWQgPSA/XG4gICAgICAgICAgICAgICAgYCkuZ2V0KGZvbGRlcklkKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoIWNoZWNrRm9sZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yKGDinYwgRm9sZGVyIHdpdGggSUQgJHtmb2xkZXJJZH0gZG9lcyBub3QgZXhpc3RgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGBGb2xkZXIgd2l0aCBJRCAke2ZvbGRlcklkfSBkb2VzIG5vdCBleGlzdGAsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGltcG9ydGVkOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWw6IDBcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gdGV4dC5zcGxpdCgnXFxuJykubWFwKGxpbmUgPT4gbGluZS50cmltKCkpLmZpbHRlcihsaW5lID0+IGxpbmUubGVuZ3RoID4gMCk7XG4gICAgICAgICAgICBjb25zdCByZXN1bHRzID0gW107XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgICAgICAgICAgIC8vIFBhcnNlIGFjY291bnQgaW5mbyB04burIGxpbmVcbiAgICAgICAgICAgICAgICBjb25zdCBhY2NvdW50RGF0YSA9IHRoaXMucGFyc2VBY2NvdW50TGluZShsaW5lKTtcbiAgICAgICAgICAgICAgICBhY2NvdW50RGF0YS5mb2xkZXJJZCA9IGZvbGRlcklkO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYWRkQWNjb3VudChhY2NvdW50RGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogYWNjb3VudERhdGEudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiByZXN1bHQuc3VjY2VzcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiByZXN1bHQuZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IoYOKdjCBFcnJvciBhZGRpbmcgYWNjb3VudCAke2FjY291bnREYXRhLnVzZXJuYW1lfTpgLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogYWNjb3VudERhdGEudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3Qgc3VjY2Vzc0NvdW50ID0gcmVzdWx0cy5maWx0ZXIociA9PiByLnN1Y2Nlc3MpLmxlbmd0aDtcbiAgICAgICAgICAgIGxvZyhg4pyFIEltcG9ydGVkICR7c3VjY2Vzc0NvdW50fS8ke3Jlc3VsdHMubGVuZ3RofSBhY2NvdW50c2ApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcmVzdWx0czogcmVzdWx0cyxcbiAgICAgICAgICAgICAgICBpbXBvcnRlZDogc3VjY2Vzc0NvdW50LFxuICAgICAgICAgICAgICAgIHRvdGFsOiByZXN1bHRzLmxlbmd0aFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGVycm9yKCfinYwgRXJyb3IgaW1wb3J0aW5nIGFjY291bnRzIGZyb20gdGV4dDonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgICAgICAgIHJlc3VsdHM6IFtdLFxuICAgICAgICAgICAgICAgIGltcG9ydGVkOiAwLFxuICAgICAgICAgICAgICAgIHRvdGFsOiAwXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYWNjb3VudCBsaW5lIHThu6sgdGV4dFxuICAgICAqL1xuICAgIHBhcnNlQWNjb3VudExpbmUobGluZSkge1xuICAgICAgICAvLyBTdXBwb3J0IG11bHRpcGxlIGZvcm1hdHM6XG4gICAgICAgIC8vIDEuIEp1c3QgdXNlcm5hbWU6IFwidXNlcm5hbWUxMjNcIlxuICAgICAgICAvLyAyLiBVc2VybmFtZTpzZXNzaW9uSWQ6IFwidXNlcm5hbWUxMjM6c2Vzc2lvbl90b2tlbl9oZXJlXCIgXG4gICAgICAgIC8vIDMuIEpTT04gZm9ybWF0OiB7XCJ1c2VybmFtZVwiOiBcInVzZXJuYW1lMTIzXCIsIFwic2Vzc2lvbklkXCI6IFwidG9rZW5cIiwgLi4ufVxuICAgICAgICAvLyA0LiBQaXBlLXNlcGFyYXRlZDogXCJ1c2VybmFtZXxwYXNzd29yZHxlbWFpbHxlbWFpbHBhc3N8Y29va2llXCJcbiAgICAgICAgXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBUcnkgSlNPTiBmb3JtYXQgZmlyc3RcbiAgICAgICAgICAgIGNvbnN0IGpzb25EYXRhID0gSlNPTi5wYXJzZShsaW5lKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IGpzb25EYXRhLnVzZXJuYW1lIHx8IGpzb25EYXRhLnVzZXIgfHwgJycsXG4gICAgICAgICAgICAgICAgc2Vzc2lvbklkOiBqc29uRGF0YS5zZXNzaW9uSWQgfHwganNvbkRhdGEuc2Vzc2lvbiB8fCBudWxsLFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBqc29uRGF0YS5wYXNzd29yZCB8fCBudWxsLFxuICAgICAgICAgICAgICAgIGVtYWlsOiBqc29uRGF0YS5lbWFpbCB8fCBudWxsLFxuICAgICAgICAgICAgICAgIGVtYWlsUGFzc3dvcmQ6IGpzb25EYXRhLmVtYWlsUGFzc3dvcmQgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBjb29raWU6IGpzb25EYXRhLmNvb2tpZSB8fCBudWxsLFxuICAgICAgICAgICAgICAgIGxhc3RVc2VkOiBqc29uRGF0YS5sYXN0VXNlZCB8fCBudWxsLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRSb29tczoganNvbkRhdGEuY3VycmVudFJvb21zIHx8IDAsXG4gICAgICAgICAgICAgICAgYXZhdGFyVGh1bWI6IGpzb25EYXRhLmF2YXRhclRodW1iIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgcm9vbVVzZXJuYW1lOiBqc29uRGF0YS5yb29tVXNlcm5hbWUgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBhY3RpdmVSb29tczoganNvbkRhdGEuYWN0aXZlUm9vbXMgfHwgW10sXG4gICAgICAgICAgICAgICAgbm90ZXM6IGpzb25EYXRhLm5vdGVzIHx8ICcnLFxuICAgICAgICAgICAgICAgIHN0YXR1czoganNvbkRhdGEuc3RhdHVzIHx8ICdhY3RpdmUnLFxuICAgICAgICAgICAgICAgIHByb3h5SWQ6IGpzb25EYXRhLnByb3h5SWQgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBtZXRhZGF0YToganNvbkRhdGEubWV0YWRhdGEgfHwge31cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgLy8gVGjhu60gZm9ybWF0IHBpcGUtc2VwYXJhdGVkXG4gICAgICAgICAgICBpZiAobGluZS5pbmNsdWRlcygnfCcpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsaW5lLnNwbGl0KCd8Jyk7XG4gICAgICAgICAgICAgICAgLy8gdXNlcm5hbWV8cGFzc3dvcmR8ZW1haWx8ZW1haWxwYXNzfGNvb2tpZVxuICAgICAgICAgICAgICAgIGNvbnN0IHVzZXJuYW1lID0gcGFydHNbMF0/LnRyaW0oKSB8fCAnJztcbiAgICAgICAgICAgICAgICBjb25zdCBwYXNzd29yZCA9IHBhcnRzWzFdPy50cmltKCkgfHwgJyc7XG4gICAgICAgICAgICAgICAgY29uc3QgZW1haWwgPSBwYXJ0c1syXT8udHJpbSgpIHx8ICcnO1xuICAgICAgICAgICAgICAgIGNvbnN0IGVtYWlsUGFzc3dvcmQgPSBwYXJ0c1szXT8udHJpbSgpIHx8ICcnO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvb2tpZSA9IHBhcnRzWzRdPy50cmltKCkgfHwgJyc7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbG9nKGDwn5OdIFBhcnNlZCBwaXBlLXNlcGFyYXRlZCBhY2NvdW50OiAke3VzZXJuYW1lfWApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lLFxuICAgICAgICAgICAgICAgICAgICBzZXNzaW9uSWQ6IGNvb2tpZSB8fCBudWxsLCAvLyBDw7MgdGjhu4MgZMO5bmcgY29va2llIGzDoG0gc2Vzc2lvbklkXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkLFxuICAgICAgICAgICAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICAgICAgICAgICAgZW1haWxQYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgY29va2llLFxuICAgICAgICAgICAgICAgICAgICBub3RlczogYEVtYWlsOiAke2VtYWlsfWAsXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogJ2FjdGl2ZScsXG4gICAgICAgICAgICAgICAgICAgIHByb3h5SWQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSb29tczogMCxcbiAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGE6IHt9LFxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVSb29tczogW11cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gVGjhu60gZm9ybWF0IGNvbG9uLXNlcGFyYXRlZFxuICAgICAgICAgICAgZWxzZSBpZiAobGluZS5pbmNsdWRlcygnOicpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsaW5lLnNwbGl0KCc6Jyk7XG4gICAgICAgICAgICAgICAgLy8gQ8OzIHRo4buDIGPDsyBuaGnhu4F1IGjGoW4gMiBwaOG6p24gKHVzZXJuYW1lOnNlc3Npb25JZDpub3RlOnN0YXR1cy4uLilcbiAgICAgICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoID49IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiBwYXJ0c1swXS50cmltKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uSWQ6IHBhcnRzWzFdLnRyaW0oKSB8fCBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgbm90ZXM6IHBhcnRzWzJdID8gcGFydHNbMl0udHJpbSgpIDogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHBhcnRzWzNdID8gcGFydHNbM10udHJpbSgpIDogJ2FjdGl2ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm94eUlkOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFJvb21zOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGE6IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlUm9vbXM6IFtdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBKdXN0IHVzZXJuYW1lXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiBsaW5lLnRyaW0oKSxcbiAgICAgICAgICAgICAgICBzZXNzaW9uSWQ6IG51bGwsXG4gICAgICAgICAgICAgICAgbm90ZXM6ICcnLFxuICAgICAgICAgICAgICAgIHN0YXR1czogJ2FjdGl2ZScsXG4gICAgICAgICAgICAgICAgcHJveHlJZDogbnVsbCxcbiAgICAgICAgICAgICAgICBjdXJyZW50Um9vbXM6IDAsXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IHt9LFxuICAgICAgICAgICAgICAgIGFjdGl2ZVJvb21zOiBbXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBBY2NvdW50U3RvcmFnZTsgIiwiY29uc3QgRGF0YWJhc2UgPSByZXF1aXJlKCdiZXR0ZXItc3FsaXRlMycpO1xuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcbmNvbnN0IHsgbG9nLCBlcnJvciB9ID0gcmVxdWlyZSgnLi4vbG9nZ2VyJyk7XG5cbmNsYXNzIEJhc2VTdG9yYWdlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5kYiA9IG51bGw7XG4gICAgICAgIHRoaXMuZGJQYXRoID0gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuZGVmYXVsdFNldHRpbmdzID0ge1xuICAgICAgICAgICAgYXV0b1N0YXJ0OiBmYWxzZSxcbiAgICAgICAgICAgIG1pbmltaXplVG9UcmF5OiB0cnVlLFxuICAgICAgICAgICAgdGhlbWU6ICdkYXJrJyxcbiAgICAgICAgICAgIG5vdGlmaWNhdGlvbnM6IHRydWUsXG4gICAgICAgICAgICBhdXRvVXBkYXRlOiB0cnVlLFxuICAgICAgICAgICAgbWF4Q29uY3VycmVudENvbm5lY3Rpb25zOiA1LFxuICAgICAgICAgICAgY29ubmVjdGlvblRpbWVvdXQ6IDMwMDAwLFxuICAgICAgICAgICAgcmV0cnlEZWxheTogNTAwMCxcbiAgICAgICAgICAgIG1heFJldHJpZXM6IDNcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBLaOG7n2kgdOG6oW8gZGF0YWJhc2UgY29ubmVjdGlvblxuICAgICAqL1xuICAgIGFzeW5jIGluaXQoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB7IGFwcCB9ID0gcmVxdWlyZSgnZWxlY3Ryb24nKTtcbiAgICAgICAgICAgIGNvbnN0IHVzZXJEYXRhUGF0aCA9IGFwcC5nZXRQYXRoKCd1c2VyRGF0YScpO1xuICAgICAgICAgICAgdGhpcy5kYlBhdGggPSBwYXRoLmpvaW4odXNlckRhdGFQYXRoLCAndGlrdG9rLWxpdmUuZGInKTtcblxuICAgICAgICAgICAgLy8gVOG6oW8gdGjGsCBt4bulYyBu4bq/dSBjaMawYSBjw7NcbiAgICAgICAgICAgIGNvbnN0IGRpciA9IHBhdGguZGlybmFtZSh0aGlzLmRiUGF0aCk7XG4gICAgICAgICAgICBpZiAoIWZzLmV4aXN0c1N5bmMoZGlyKSkge1xuICAgICAgICAgICAgICAgIGZzLm1rZGlyU3luYyhkaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmRiID0gbmV3IERhdGFiYXNlKHRoaXMuZGJQYXRoLCB7XG4gICAgICAgICAgICAgICAgdmVyYm9zZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBsb2cgOiBudWxsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gRW5hYmxlIFdBTCBtb2RlIHbDoCBmb3JlaWduIGtleXNcbiAgICAgICAgICAgIHRoaXMuZGIucHJhZ21hKCdqb3VybmFsX21vZGUgPSBXQUwnKTtcbiAgICAgICAgICAgIHRoaXMuZGIucHJhZ21hKCdmb3JlaWduX2tleXMgPSBPTicpO1xuICAgICAgICAgICAgdGhpcy5kYi5wcmFnbWEoJ3N5bmNocm9ub3VzID0gTk9STUFMJyk7XG5cbiAgICAgICAgICAgIGxvZygn4pyFIFNRTGl0ZSBkYXRhYmFzZSBpbml0aWFsaXplZDonLCB0aGlzLmRiUGF0aCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBlcnJvcign4p2MIEVycm9yIGluaXRpYWxpemluZyBTUUxpdGUgZGF0YWJhc2U6JywgZXJyKTtcbiAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIMSQw7NuZyBkYXRhYmFzZSBjb25uZWN0aW9uXG4gICAgICovXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIGlmICh0aGlzLmRiKSB7XG4gICAgICAgICAgICB0aGlzLmRiLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLmRiID0gbnVsbDtcbiAgICAgICAgICAgIGxvZygn4pyFIFNRTGl0ZSBkYXRhYmFzZSBjbG9zZWQnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlIHVuaXF1ZSBJRFxuICAgICAqL1xuICAgIGdlbmVyYXRlSWQoKSB7XG4gICAgICAgIHJldHVybiBEYXRlLm5vdygpLnRvU3RyaW5nKDM2KSArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IHVzZXJuYW1lIHThu6sgYWNjb3VudCBpbmZvXG4gICAgICovXG4gICAgZXh0cmFjdFVzZXJuYW1lKGFjY291bnRJbmZvKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYWNjb3VudEluZm8gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICByZXR1cm4gYWNjb3VudEluZm87XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFjY291bnRJbmZvPy51c2VybmFtZSB8fCBhY2NvdW50SW5mbz8udW5pcXVlSWQgfHwgYWNjb3VudEluZm8/LnVzZXI/LnVzZXJuYW1lIHx8ICdVbmtub3duJztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IHByb3h5IGhvc3QgdOG7qyBwcm94eSBpbmZvXG4gICAgICovXG4gICAgZXh0cmFjdFByb3h5SG9zdChwcm94eUluZm8pIHtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm94eUluZm8gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICByZXR1cm4gcHJveHlJbmZvLnNwbGl0KCc6JylbMF0gfHwgcHJveHlJbmZvO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm94eUluZm8/Lmhvc3QgfHwgcHJveHlJbmZvPy5pcCB8fCAnVW5rbm93bic7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2VyaWFsaXplIG9iamVjdCBjaG8gSVBDIGNvbXBhdGliaWxpdHlcbiAgICAgKi9cbiAgICBzZXJpYWxpemVGb3JJUEMob2JqKSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9iaikpO1xuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBCYXNlU3RvcmFnZTsgIiwiY29uc3QgQmFzZVN0b3JhZ2UgPSByZXF1aXJlKCcuL2Jhc2Utc3RvcmFnZScpO1xuY29uc3QgeyBsb2csIGVycm9yIH0gPSByZXF1aXJlKCcuLi9sb2dnZXInKTtcblxuY2xhc3MgRGF0YWJhc2VTY2hlbWEgZXh0ZW5kcyBCYXNlU3RvcmFnZSB7XG4gICAgLyoqXG4gICAgICogVOG6oW8gdOG6pXQgY+G6oyB0YWJsZXNcbiAgICAgKi9cbiAgICBjcmVhdGVUYWJsZXMoKSB7XG4gICAgICAgIGxvZygn8J+UpyBDcmVhdGluZyBkYXRhYmFzZSB0YWJsZXMuLi4nKTtcblxuICAgICAgICAvLyBGb2xkZXJzIHRhYmxlXG4gICAgICAgIHRoaXMuZGIuZXhlYyhgXG4gICAgICAgICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBmb2xkZXJzIChcbiAgICAgICAgICAgICAgICBpZCBURVhUIFBSSU1BUlkgS0VZLFxuICAgICAgICAgICAgICAgIG5hbWUgVEVYVCBOT1QgTlVMTCxcbiAgICAgICAgICAgICAgICB0eXBlIFRFWFQgTk9UIE5VTEwgQ0hFQ0sgKHR5cGUgSU4gKCdhY2NvdW50cycsICdwcm94aWVzJykpLFxuICAgICAgICAgICAgICAgIGNvbG9yIFRFWFQgREVGQVVMVCAnIzAwN2JmZicsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24gVEVYVCBERUZBVUxUICcnLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdCBURVhUIE5PVCBOVUxMLFxuICAgICAgICAgICAgICAgIHVwZGF0ZWRBdCBURVhUIE5PVCBOVUxMLFxuICAgICAgICAgICAgICAgIFVOSVFVRShuYW1lLCB0eXBlKVxuICAgICAgICAgICAgKVxuICAgICAgICBgKTtcblxuICAgICAgICAvLyBBY2NvdW50cyB0YWJsZVxuICAgICAgICB0aGlzLmRiLmV4ZWMoYFxuICAgICAgICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgYWNjb3VudHMgKFxuICAgICAgICAgICAgICAgIGlkIFRFWFQgUFJJTUFSWSBLRVksXG4gICAgICAgICAgICAgICAgdXNlcm5hbWUgVEVYVCBOT1QgTlVMTCBVTklRVUUsXG4gICAgICAgICAgICAgICAgc2Vzc2lvbklkIFRFWFQsXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQgVEVYVCxcbiAgICAgICAgICAgICAgICBlbWFpbCBURVhULFxuICAgICAgICAgICAgICAgIGVtYWlsUGFzc3dvcmQgVEVYVCxcbiAgICAgICAgICAgICAgICBjb29raWUgVEVYVCxcbiAgICAgICAgICAgICAgICBmb2xkZXJJZCBURVhULFxuICAgICAgICAgICAgICAgIHN0YXR1cyBURVhUIERFRkFVTFQgJ2luYWN0aXZlJyBDSEVDSyAoc3RhdHVzIElOICgnYWN0aXZlJywgJ2luYWN0aXZlJywgJ2Vycm9yJywgJ2Nvbm5lY3RpbmcnKSksXG4gICAgICAgICAgICAgICAgbGFzdEFjdGl2ZSBURVhULFxuICAgICAgICAgICAgICAgIGxhc3RVc2VkIFRFWFQsXG4gICAgICAgICAgICAgICAgY3VycmVudFJvb21zIElOVEVHRVIgREVGQVVMVCAwLFxuICAgICAgICAgICAgICAgIGF2YXRhclRodW1iIFRFWFQsXG4gICAgICAgICAgICAgICAgcm9vbVVzZXJuYW1lIFRFWFQsXG4gICAgICAgICAgICAgICAgYWN0aXZlUm9vbXMgVEVYVCBERUZBVUxUICdbXScsXG4gICAgICAgICAgICAgICAgdmlld2VyQ291bnQgSU5URUdFUiBERUZBVUxUIDAsXG4gICAgICAgICAgICAgICAgZm9sbG93Q291bnQgSU5URUdFUiBERUZBVUxUIDAsXG4gICAgICAgICAgICAgICAgc2hhcmVDb3VudCBJTlRFR0VSIERFRkFVTFQgMCxcbiAgICAgICAgICAgICAgICB0b3RhbFZpZXdzIElOVEVHRVIgREVGQVVMVCAwLFxuICAgICAgICAgICAgICAgIHRvdGFsU2hhcmVzIElOVEVHRVIgREVGQVVMVCAwLFxuICAgICAgICAgICAgICAgIHRvdGFsRm9sbG93cyBJTlRFR0VSIERFRkFVTFQgMCxcbiAgICAgICAgICAgICAgICBpc0xpdmUgSU5URUdFUiBERUZBVUxUIDAsXG4gICAgICAgICAgICAgICAgcHJveHlJZCBURVhULFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhIFRFWFQgREVGQVVMVCAne30nLFxuICAgICAgICAgICAgICAgIG5vdGVzIFRFWFQgREVGQVVMVCAnJyxcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQgVEVYVCBOT1QgTlVMTCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQgVEVYVCBOT1QgTlVMTCxcbiAgICAgICAgICAgICAgICBGT1JFSUdOIEtFWSAoZm9sZGVySWQpIFJFRkVSRU5DRVMgZm9sZGVycyhpZCkgT04gREVMRVRFIFNFVCBOVUxMLFxuICAgICAgICAgICAgICAgIEZPUkVJR04gS0VZIChwcm94eUlkKSBSRUZFUkVOQ0VTIHByb3hpZXMoaWQpIE9OIERFTEVURSBTRVQgTlVMTFxuICAgICAgICAgICAgKVxuICAgICAgICBgKTtcblxuICAgICAgICAvLyBQcm94aWVzIHRhYmxlICBcbiAgICAgICAgdGhpcy5kYi5leGVjKGBcbiAgICAgICAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHByb3hpZXMgKFxuICAgICAgICAgICAgICAgIGlkIFRFWFQgUFJJTUFSWSBLRVksXG4gICAgICAgICAgICAgICAgaG9zdCBURVhUIE5PVCBOVUxMLFxuICAgICAgICAgICAgICAgIHBvcnQgSU5URUdFUiBOT1QgTlVMTCxcbiAgICAgICAgICAgICAgICB1c2VybmFtZSBURVhULFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkIFRFWFQsXG4gICAgICAgICAgICAgICAgdHlwZSBURVhUIERFRkFVTFQgJ2h0dHAnIENIRUNLICh0eXBlIElOICgnaHR0cCcsICdodHRwcycsICdzb2NrczQnLCAnc29ja3M1JykpLFxuICAgICAgICAgICAgICAgIGZvbGRlcklkIFRFWFQsXG4gICAgICAgICAgICAgICAgc3RhdHVzIFRFWFQgREVGQVVMVCAnYWN0aXZlJyBDSEVDSyAoc3RhdHVzIElOICgnYWN0aXZlJywgJ2luYWN0aXZlJywgJ2Vycm9yJywgJ3Rlc3RpbmcnLCAndW5rbm93bicpKSxcbiAgICAgICAgICAgICAgICBsYXN0VGVzdGVkIFRFWFQsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2VUaW1lIElOVEVHRVIgREVGQVVMVCAwLFxuICAgICAgICAgICAgICAgIG5vdGVzIFRFWFQgREVGQVVMVCAnJyxcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQgVEVYVCBOT1QgTlVMTCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQgVEVYVCBOT1QgTlVMTCxcbiAgICAgICAgICAgICAgICBGT1JFSUdOIEtFWSAoZm9sZGVySWQpIFJFRkVSRU5DRVMgZm9sZGVycyhpZCkgT04gREVMRVRFIFNFVCBOVUxMLFxuICAgICAgICAgICAgICAgIFVOSVFVRShob3N0LCBwb3J0KVxuICAgICAgICAgICAgKVxuICAgICAgICBgKTtcblxuICAgICAgICAvLyBSb29tcyB0YWJsZVxuICAgICAgICB0aGlzLmRiLmV4ZWMoYFxuICAgICAgICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgcm9vbXMgKFxuICAgICAgICAgICAgICAgIHVpZCBURVhUIFBSSU1BUlkgS0VZLFxuICAgICAgICAgICAgICAgIGlkIFRFWFQsXG4gICAgICAgICAgICAgICAgcm9vbUlkIFRFWFQsXG4gICAgICAgICAgICAgICAgcm9vbVVybCBURVhULFxuICAgICAgICAgICAgICAgIHJvb21Vc2VybmFtZSBURVhULFxuICAgICAgICAgICAgICAgIG5pY2tuYW1lIFRFWFQsXG4gICAgICAgICAgICAgICAgYXZhdGFyIFRFWFQsXG4gICAgICAgICAgICAgICAgYXZhdGFyVGh1bWIgVEVYVCxcbiAgICAgICAgICAgICAgICB0aXRsZSBURVhUIERFRkFVTFQgJycsXG4gICAgICAgICAgICAgICAgdmlld2VyQ291bnQgSU5URUdFUiBERUZBVUxUIDAsXG4gICAgICAgICAgICAgICAgY3VycmVudFZpZXdlcnMgSU5URUdFUiBERUZBVUxUIDAsXG4gICAgICAgICAgICAgICAgc3RhcnRDb3VudCBJTlRFR0VSIERFRkFVTFQgMCxcbiAgICAgICAgICAgICAgICB0YXJnZXRWaWV3ZXJzIElOVEVHRVIgREVGQVVMVCAwLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uIElOVEVHRVIgREVGQVVMVCAzMCxcbiAgICAgICAgICAgICAgICBpc0xpdmUgSU5URUdFUiBERUZBVUxUIDAsXG4gICAgICAgICAgICAgICAgbGFzdFZpZXdlZCBURVhULFxuICAgICAgICAgICAgICAgIG5vdGVzIFRFWFQgREVGQVVMVCAnJyxcbiAgICAgICAgICAgICAgICBzdGF0dXMgVEVYVCBERUZBVUxUICdzdG9wcGVkJyxcbiAgICAgICAgICAgICAgICBzdGFydGVkQXQgVEVYVCxcbiAgICAgICAgICAgICAgICBlbmRlZEF0IFRFWFQsXG4gICAgICAgICAgICAgICAgcmVhbFZpZXdlcnMgSU5URUdFUiBERUZBVUxUIDAsXG4gICAgICAgICAgICAgICAgbGFzdFRpbWVDaGVja1ZpZXdlcnMgVEVYVCxcbiAgICAgICAgICAgICAgICBzdG9wcGVkQXQgVEVYVCxcbiAgICAgICAgICAgICAgICBzdG9wUmVhc29uIFRFWFQsXG4gICAgICAgICAgICAgICAgZmluYWxEdXJhdGlvbiBJTlRFR0VSIERFRkFVTFQgMCxcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQgVEVYVCBOT1QgTlVMTCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQgVEVYVCBOT1QgTlVMTFxuICAgICAgICAgICAgKVxuICAgICAgICBgKTtcblxuICAgICAgICAvLyBBY2NvdW50LVJvb20gcmVsYXRpb25zaGlwIHRhYmxlXG4gICAgICAgIHRoaXMuZGIuZXhlYyhgXG4gICAgICAgICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBhY2NvdW50X3Jvb21zIChcbiAgICAgICAgICAgICAgICBpZCBJTlRFR0VSIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsXG4gICAgICAgICAgICAgICAgYWNjb3VudElkIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgICAgICAgICAgcm9vbUlkIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0IFRFWFQgTk9UIE5VTEwsXG4gICAgICAgICAgICAgICAgRk9SRUlHTiBLRVkgKGFjY291bnRJZCkgUkVGRVJFTkNFUyBhY2NvdW50cyhpZCkgT04gREVMRVRFIENBU0NBREUsXG4gICAgICAgICAgICAgICAgRk9SRUlHTiBLRVkgKHJvb21JZCkgUkVGRVJFTkNFUyByb29tcyh1aWQpIE9OIERFTEVURSBDQVNDQURFLFxuICAgICAgICAgICAgICAgIFVOSVFVRShhY2NvdW50SWQsIHJvb21JZClcbiAgICAgICAgICAgIClcbiAgICAgICAgYCk7XG5cbiAgICAgICAgLy8gVmlld2VyIGhpc3RvcnkgdGFibGVcbiAgICAgICAgdGhpcy5kYi5leGVjKGBcbiAgICAgICAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHZpZXdlcl9oaXN0b3J5IChcbiAgICAgICAgICAgICAgICBpZCBJTlRFR0VSIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsXG4gICAgICAgICAgICAgICAgcm9vbVVpZCBURVhUIE5PVCBOVUxMLFxuICAgICAgICAgICAgICAgIHZpZXdlckNvdW50IElOVEVHRVIgTk9UIE5VTEwsXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgICAgICAgICAgRk9SRUlHTiBLRVkgKHJvb21VaWQpIFJFRkVSRU5DRVMgcm9vbXModWlkKSBPTiBERUxFVEUgQ0FTQ0FERVxuICAgICAgICAgICAgKVxuICAgICAgICBgKTtcblxuICAgICAgICAvLyBTZXR0aW5ncyB0YWJsZVxuICAgICAgICB0aGlzLmRiLmV4ZWMoYFxuICAgICAgICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgc2V0dGluZ3MgKFxuICAgICAgICAgICAgICAgIGtleSBURVhUIFBSSU1BUlkgS0VZLFxuICAgICAgICAgICAgICAgIHZhbHVlIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0IFRFWFQgTk9UIE5VTExcbiAgICAgICAgICAgIClcbiAgICAgICAgYCk7XG5cbiAgICAgICAgLy8gVGFza3MgdGFibGVcbiAgICAgICAgdGhpcy5kYi5leGVjKGBcbiAgICAgICAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHRhc2tzIChcbiAgICAgICAgICAgICAgICBpZCBURVhUIFBSSU1BUlkgS0VZLFxuICAgICAgICAgICAgICAgIG5hbWUgVEVYVCBOT1QgTlVMTCxcbiAgICAgICAgICAgICAgICBoYW5kbGVyIFRFWFQgTk9UIE5VTEwsXG4gICAgICAgICAgICAgICAgaW50ZXJ2YWwgSU5URUdFUiBOT1QgTlVMTCxcbiAgICAgICAgICAgICAgICBlbmFibGVkIElOVEVHRVIgREVGQVVMVCAxLFxuICAgICAgICAgICAgICAgIHN0YXR1cyBURVhUIERFRkFVTFQgJ2lkbGUnIENIRUNLIChzdGF0dXMgSU4gKCdpZGxlJywgJ3J1bm5pbmcnLCAnY29tcGxldGVkJywgJ2ZhaWxlZCcpKSxcbiAgICAgICAgICAgICAgICBsYXN0UnVuIFRFWFQsXG4gICAgICAgICAgICAgICAgbmV4dFJ1biBURVhULFxuICAgICAgICAgICAgICAgIHJ1bkNvdW50IElOVEVHRVIgREVGQVVMVCAwLFxuICAgICAgICAgICAgICAgIGVycm9yQ291bnQgSU5URUdFUiBERUZBVUxUIDAsXG4gICAgICAgICAgICAgICAgbGFzdEVycm9yIFRFWFQsXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0IFRFWFQgTk9UIE5VTEwsXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0IFRFWFQgTk9UIE5VTExcbiAgICAgICAgICAgIClcbiAgICAgICAgYCk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIGluZGV4ZXMgZm9yIGJldHRlciBwZXJmb3JtYW5jZVxuICAgICAgICB0aGlzLmNyZWF0ZUluZGV4ZXMoKTtcblxuICAgICAgICBsb2coJ+KchSBEYXRhYmFzZSB0YWJsZXMgY3JlYXRlZCBzdWNjZXNzZnVsbHknKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBU4bqhbyBpbmRleGVzXG4gICAgICovXG4gICAgY3JlYXRlSW5kZXhlcygpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEZvbGRlcnMgaW5kZXhlc1xuICAgICAgICAgICAgdGhpcy5kYi5leGVjKGBDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfZm9sZGVyc190eXBlIE9OIGZvbGRlcnModHlwZSlgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWNjb3VudHMgaW5kZXhlc1xuICAgICAgICAgICAgdGhpcy5kYi5leGVjKGBDUkVBV