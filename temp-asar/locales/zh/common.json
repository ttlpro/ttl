XNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nO1xuICAgICAgICAgICAgbGV0IHRyYW5zbGF0aW9uUGF0aDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGlzUHJvZCkge1xuICAgICAgICAgICAgICAgIC8vIFRyb25nIG3DtGkgdHLGsOG7nW5nIHByb2R1Y3Rpb24sIMSRxrDhu51uZyBk4bqrbiB04bubaSB0aMawIG3hu6VjIGxvY2FsZXMgxJHDoyBnaeG6o2kgbsOpblxuICAgICAgICAgICAgICAgIGNvbnN0IGFwcFBhdGggPSBhcHAuZ2V0QXBwUGF0aCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFwcERpciA9IHBhdGguZGlybmFtZShhcHBQYXRoKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBUaOG7rSB0w6xtIHRyb25nIHRoxrAgbeG7pWMgbG9jYWxlcyBnaeG6o2kgbsOpbiDhu58gY8O5bmcgY+G6pXAgduG7m2kgYXBwLmFzYXJcbiAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblBhdGggPSBwYXRoLmpvaW4oYXBwRGlyLCAnbG9jYWxlcycsIGxhbmcsICdub3RpZmljYXRpb24uanNvbicpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFRyw6puIG1hY09TIGPDsyB0aOG7gyBjw7MgY+G6pXUgdHLDumMga2jDoWNcbiAgICAgICAgICAgICAgICBpZiAocHJvY2Vzcy5wbGF0Zm9ybSA9PT0gJ2RhcndpbicgJiYgIWZzLmV4aXN0c1N5bmModHJhbnNsYXRpb25QYXRoKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBUaOG7rSB0w6xtIHRyb25nIFJlc291cmNlc1xuICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5yZXNvdXJjZXNQYXRoLCAnbG9jYWxlcycsIGxhbmcsICdub3RpZmljYXRpb24uanNvbicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gTcO0aSB0csaw4budbmcgZGV2ZWxvcG1lbnRcbiAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblBhdGggPSBwYXRoLmpvaW4oYXBwLmdldEFwcFBhdGgoKSwgJ3JlbmRlcmVyJywgJ2xvY2FsZXMnLCBsYW5nLCAnbm90aWZpY2F0aW9uLmpzb24nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbG9nKGDwn4yQIMSQYW5nIMSR4buNYyBi4bqjbiBk4buLY2ggdOG7qzogJHt0cmFuc2xhdGlvblBhdGh9YCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChmcy5leGlzdHNTeW5jKHRyYW5zbGF0aW9uUGF0aCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gZnMucmVhZEZpbGVTeW5jKHRyYW5zbGF0aW9uUGF0aCwgJ3V0ZjgnKTtcbiAgICAgICAgICAgICAgICBjb25zdCB0cmFuc2xhdGlvbnMgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICAgICAgICAgIGxvZyhg4pyFIMSQ4buNYyBi4bqjbiBk4buLY2ggJHtsYW5nfSB0aMOgbmggY8O0bmdgKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNsYXRpb25zO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsb2coYOKdjCBLaMO0bmcgdMOsbSB0aOG6pXkgZmlsZSBi4bqjbiBk4buLY2ggY2hvICR7bGFuZ30gdOG6oWkgJHt0cmFuc2xhdGlvblBhdGh9YCk7XG4gICAgICAgICAgICAgICAgLy8gTuG6v3Uga2jDtG5nIHTDrG0gdGjhuqV5LCB0aOG7rSDEkeG7jWMgdGnhur9uZyBWaeG7h3RcbiAgICAgICAgICAgICAgICBpZiAobGFuZyAhPT0gJ3ZpJykge1xuICAgICAgICAgICAgICAgICAgICBsb2coYPCflIQgxJBhbmcgZmFsbGJhY2sgduG7gSB0aeG6v25nIFZp4buHdGApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5sb2FkVHJhbnNsYXRpb25zKCd2aScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBO4bq/dSBraMO0bmcgY8OzIGPhuqMgdGnhur9uZyBWaeG7h3QsIHRy4bqjIHbhu4Egb2JqZWN0IHLhu5duZ1xuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBlcnJvcihg4p2MIEzhu5dpIGtoaSDEkeG7jWMgYuG6o24gZOG7i2NoICR7bGFuZ306YCwgZXJyKTtcbiAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIMSQ4bq3dCBuZ8O0biBuZ+G7ryBoaeG7h24gdOG6oWlcbiAgICAgKi9cbiAgICBzZXRMYW5ndWFnZShsYW5nKSB7XG4gICAgICAgIC8vIEPhuq1wIG5o4bqtdCBuZ8O0biBuZ+G7ryB0cm9uZyBBcHBTdGF0ZSwgTm90aWZpY2F0aW9uTWFuYWdlciBz4bq9IMSRxrDhu6NjIGPhuq1wIG5o4bqtdCBxdWEgbGlzdGVuZXJcbiAgICAgICAgYXBwU3RhdGUubGFuZ3VhZ2UgPSBsYW5nO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBoxrDGoW5nIHRo4bupYyB0KCkgxJHhu4MgbOG6pXkgYuG6o24gZOG7i2NoXG4gICAgICovXG4gICAgdChrZXksIHBhcmFtcyA9IHt9KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBQaMOibiB0w6FjaCBrZXlcbiAgICAgICAgICAgIGNvbnN0IGtleVBhcnRzID0ga2V5LnNwbGl0KCcuJyk7XG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy50cmFuc2xhdGlvbnM7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIER1eeG7h3QgcXVhIGPDoWMgcGjhuqduIGPhu6dhIGtleVxuICAgICAgICAgICAgZm9yIChjb25zdCBwYXJ0IG9mIGtleVBhcnRzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHRbcGFydF0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHRbcGFydF07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nKGDinZMgS2jDtG5nIHTDrG0gdGjhuqV5IGtleSAke2tleX0gdHJvbmcgYuG6o24gZOG7i2NoICR7YXBwU3RhdGUubGFuZ3VhZ2V9YCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBrZXk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUaGF5IHRo4bq/IGPDoWMgdGhhbSBz4buRXG4gICAgICAgICAgICBpZiAodHlwZW9mIHJlc3VsdCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHBhcmFtS2V5IGluIHBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShgeyR7cGFyYW1LZXl9fWAsIHBhcmFtc1twYXJhbUtleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBlcnJvcihg4p2MIEzhu5dpIGtoaSBk4buLY2gga2V5ICR7a2V5fTpgLCBlcnIpO1xuICAgICAgICAgICAgcmV0dXJuIGtleTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEfhu61pIHRow7RuZyBiw6FvXG4gICAgICovXG4gICAgc2VuZE5vdGlmaWNhdGlvbihvcHRpb25zKSB7XG4gICAgICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICAgICAgICBsb2coJ+KdjCBUaMO0bmcgYsOhbyDEkcOjIGLhu4sgdOG6r3QsIGtow7RuZyBn4butaSB0aMO0bmcgYsOhbycpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsb2coYPCfk6IgxJBhbmcgZ+G7rWkgdGjDtG5nIGLDoW86ICR7b3B0aW9ucy50aXRsZX1gKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdBTUFDIFRpa1RvayBMaXZlJyxcbiAgICAgICAgICAgICAgICBib2R5OiAnJyxcbiAgICAgICAgICAgICAgICBpY29uOiBvcHRpb25zLmljb24gfHwgdGhpcy5pY29uUGF0aCxcbiAgICAgICAgICAgICAgICBzaWxlbnQ6ICF0aGlzLnNvdW5kRW5hYmxlZCxcbiAgICAgICAgICAgICAgICB0aW1lb3V0VHlwZTogJ2RlZmF1bHQnXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBub3RpZmljYXRpb25PcHRpb25zID0geyAuLi5kZWZhdWx0T3B0aW9ucywgLi4ub3B0aW9ucyB9O1xuICAgICAgICAgICAgbG9nKGDwn5OiIENoaSB0aeG6v3QgdGjDtG5nIGLDoW86ICR7SlNPTi5zdHJpbmdpZnkobm90aWZpY2F0aW9uT3B0aW9ucyl9YCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFThuqFvIHRow7RuZyBiw6FvIHbhu5tpIHTDuXkgY2jhu41uIMSR4bqneSDEkeG7p1xuICAgICAgICAgICAgY29uc3Qgbm90aWZpY2F0aW9uID0gbmV3IE5vdGlmaWNhdGlvbih7XG4gICAgICAgICAgICAgICAgdGl0bGU6IG5vdGlmaWNhdGlvbk9wdGlvbnMudGl0bGUsXG4gICAgICAgICAgICAgICAgYm9keTogbm90aWZpY2F0aW9uT3B0aW9ucy5ib2R5LFxuICAgICAgICAgICAgICAgIGljb246IG5vdGlmaWNhdGlvbk9wdGlvbnMuaWNvbixcbiAgICAgICAgICAgICAgICBzaWxlbnQ6IG5vdGlmaWNhdGlvbk9wdGlvbnMuc2lsZW50LFxuICAgICAgICAgICAgICAgIHVyZ2VuY3k6IG5vdGlmaWNhdGlvbk9wdGlvbnMudXJnZW5jeSB8fCAnbm9ybWFsJyxcbiAgICAgICAgICAgICAgICB0aW1lb3V0VHlwZTogbm90aWZpY2F0aW9uT3B0aW9ucy50aW1lb3V0VHlwZSB8fCAnZGVmYXVsdCcsXG4gICAgICAgICAgICAgICAgaGFzUmVwbHk6IGZhbHNlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTMawdSB0aGFtIGNoaeG6v3UgxJHhur9uIHRow7RuZyBiw6FvIMSR4buDIHRyw6FuaCBi4buLIGdhcmJhZ2UgY29sbGVjdGVkXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZU5vdGlmaWNhdGlvbnMucHVzaChub3RpZmljYXRpb24pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyDEkMSDbmcga8O9IGPDoWMgc+G7sSBraeG7h25cbiAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5vbignc2hvdycsICgpID0+IHtcbiAgICAgICAgICAgICAgICBsb2coYPCfk6IgVGjDtG5nIGLDoW8gaGnhu4NuIHRo4buLOiAke25vdGlmaWNhdGlvbk9wdGlvbnMudGl0bGV9YCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbm90aWZpY2F0aW9uLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICBsb2coYPCfk6IgVGjDtG5nIGLDoW8gxJHGsOG7o2MgbmjhuqVwOiAke25vdGlmaWNhdGlvbk9wdGlvbnMudGl0bGV9YCk7XG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMub25DbGljaykge1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLm9uQ2xpY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhck5vdGlmaWNhdGlvbihub3RpZmljYXRpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5vbignY2xvc2UnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbG9nKGDwn5OiIFRow7RuZyBiw6FvIMSRw7NuZzogJHtub3RpZmljYXRpb25PcHRpb25zLnRpdGxlfWApO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJOb3RpZmljYXRpb24obm90aWZpY2F0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBub3RpZmljYXRpb24ub24oJ2ZhaWxlZCcsIChldmVudCwgZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgbG9nKGDinYwgTOG7l2kgdGjDtG5nIGLDoW86ICR7ZXJyfWApO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJOb3RpZmljYXRpb24obm90aWZpY2F0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBIaeG7g24gdGjhu4sgdGjDtG5nIGLDoW9cbiAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5zaG93KCk7XG4gICAgICAgICAgICBsb2coYPCfk6IgxJDDoyBn4buNaSBow6BtIHNob3coKSBjaG8gdGjDtG5nIGLDoW9gKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTMawdSB2w6BvIGzhu4tjaCBz4butXG4gICAgICAgICAgICB0aGlzLmFkZFRvSGlzdG9yeSh7XG4gICAgICAgICAgICAgICAgdGl0bGU6IG5vdGlmaWNhdGlvbk9wdGlvbnMudGl0bGUsXG4gICAgICAgICAgICAgICAgYm9keTogbm90aWZpY2F0aW9uT3B0aW9ucy5ib2R5LFxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIG5vdGlmaWNhdGlvbjtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBlcnJvcign4p2MIEzhu5dpIGtoaSBn4butaSB0aMO0bmcgYsOhbzonLCBlcnIpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBIaeG7g24gdGjhu4sgZGlhbG9nIHRoYXkgdGjhur8gbuG6v3UgY8OzIGzhu5dpXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGRpYWxvZy5zaG93TWVzc2FnZUJveCh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdpbmZvJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IG9wdGlvbnMudGl0bGUgfHwgJ0FNQUMgVGlrVG9rIExpdmUnLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBvcHRpb25zLmJvZHkgfHwgJycsXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbnM6IFsnT0snXVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBjYXRjaCAoZGlhbG9nRXJyKSB7XG4gICAgICAgICAgICAgICAgZXJyb3IoJ+KdjCBM4buXaSBraGkgaGnhu4NuIHRo4buLIGRpYWxvZyB0aGF5IHRo4bq/OicsIGRpYWxvZ0Vycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFjDs2EgdGjDtG5nIGLDoW8ga2jhu49pIGRhbmggc8OhY2ggdGhhbSBjaGnhur91XG4gICAgICovXG4gICAgY2xlYXJOb3RpZmljYXRpb24obm90aWZpY2F0aW9uVG9EZWxldGUpIHtcbiAgICAgICAgdGhpcy5hY3RpdmVOb3RpZmljYXRpb25zID0gdGhpcy5hY3RpdmVOb3RpZmljYXRpb25zLmZpbHRlcihcbiAgICAgICAgICAgIG5vdGlmaWNhdGlvbiA9PiBub3RpZmljYXRpb24gIT09IG5vdGlmaWNhdGlvblRvRGVsZXRlXG4gICAgICAgICk7XG4gICAgICAgIGxvZyhg8J+ToiDEkMOjIHjDs2EgdGjDtG5nIGLDoW8ga2jhu49pIGRhbmggc8OhY2ggdGhhbSBjaGnhur91LCBjw7JuIGzhuqFpICR7dGhpcy5hY3RpdmVOb3RpZmljYXRpb25zLmxlbmd0aH0gdGjDtG5nIGLDoW9gKTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogR+G7rWkgdGjDtG5nIGLDoW8ga2hpIHJvb20gZOG7q25nXG4gICAgICovXG4gICAgbm90aWZ5Um9vbVN0b3BwZWQocm9vbURhdGEpIHtcbiAgICAgICAgbG9nKGDwn5OiIEfhu41pIG5vdGlmeVJvb21TdG9wcGVkIHbhu5tpIHJvb21EYXRhOiAke0pTT04uc3RyaW5naWZ5KHJvb21EYXRhKX1gKTtcbiAgICAgICAgY29uc3Qgcm9vbUlkZW50aWZpZXIgPSByb29tRGF0YS5yb29tVXNlcm5hbWUgfHwgcm9vbURhdGEucm9vbU5hbWUgfHwgcm9vbURhdGEucm9vbUlkIHx8ICdVbmtub3duJztcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VuZE5vdGlmaWNhdGlvbih7XG4gICAgICAgICAgICB0aXRsZTogdGhpcy50KCdub3RpZmljYXRpb25zLnJvb21TdG9wcGVkLnRpdGxlJyksXG4gICAgICAgICAgICBib2R5OiB0aGlzLnQoJ25vdGlmaWNhdGlvbnMucm9vbVN0b3BwZWQuYm9keScsIHtyb29tSWRlbnRpZmllcn0pLFxuICAgICAgICAgICAgdXJnZW5jeTogJ25vcm1hbCcsXG4gICAgICAgICAgICB0aW1lb3V0VHlwZTogJ2RlZmF1bHQnLFxuICAgICAgICAgICAgb25DbGljazogKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIEFjdGlvbiBraGkgY2xpY2sgdsOgbyB0aMO0bmcgYsOhb1xuICAgICAgICAgICAgICAgIGxvZyhg8J+TsSBOZ8aw4budaSBkw7luZyBuaOG6pXAgdsOgbyB0aMO0bmcgYsOhbyByb29tIGThu6tuZzogJHtyb29tSWRlbnRpZmllcn1gKTtcbiAgICAgICAgICAgICAgICAvLyBDw7MgdGjhu4MgdHJp4buDbiBraGFpIG3hu58gY+G7rWEgc+G7lSByb29tIGhpc3RvcnlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIEfhu61pIHRow7RuZyBiw6FvIGtoaSBwaMOhdCBoaeG7h24gcm9vbSBt4bubaVxuICAgICAqL1xuICAgIG5vdGlmeU5ld1Jvb20ocm9vbURhdGEpIHtcbiAgICAgICAgbG9nKGDwn5OiIEfhu41pIG5vdGlmeU5ld1Jvb20gduG7m2kgcm9vbURhdGE6ICR7SlNPTi5zdHJpbmdpZnkocm9vbURhdGEpfWApO1xuICAgICAgICBjb25zdCByb29tSWRlbnRpZmllciA9IHJvb21EYXRhLnJvb21Vc2VybmFtZSB8fCByb29tRGF0YS5yb29tTmFtZSB8fCByb29tRGF0YS5yb29tSWQgfHwgJ1Vua25vd24nO1xuICAgICAgICByZXR1cm4gdGhpcy5zZW5kTm90aWZpY2F0aW9uKHtcbiAgICAgICAgICAgIHRpdGxlOiB0aGlzLnQoJ25vdGlmaWNhdGlvbnMubmV3Um9vbS50aXRsZScpLFxuICAgICAgICAgICAgYm9keTogdGhpcy50KCdub3RpZmljYXRpb25zLm5ld1Jvb20uYm9keScsIHtyb29tSWRlbnRpZmllcn0pLFxuICAgICAgICAgICAgdXJnZW5jeTogJ25vcm1hbCcsXG4gICAgICAgICAgICBvbkNsaWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbG9nKGDwn5OxIE5nxrDhu51pIGTDuW5nIG5o4bqlcCB2w6BvIHRow7RuZyBiw6FvIHJvb20gbeG7m2k6ICR7cm9vbUlkZW50aWZpZXJ9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBub3RpZnlUZXN0KCkge1xuICAgICAgICBsb2coYPCfk6IgR+G7jWkgbm90aWZ5VGVzdGApO1xuICAgICAgICByZXR1cm4gdGhpcy5zZW5kTm90aWZpY2F0aW9uKHtcbiAgICAgICAgICAgIHRpdGxlOiB0aGlzLnQoJ25vdGlmaWNhdGlvbnMudGVzdC50aXRsZScpLFxuICAgICAgICAgICAgYm9keTogdGhpcy50KCdub3RpZmljYXRpb25zLnRlc3QuYm9keScpLFxuICAgICAgICAgICAgdXJnZW5jeTogJ25vcm1hbCcsXG4gICAgICAgICAgICBvbkNsaWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbG9nKGDwn5OxIE5nxrDhu51pIGTDuW5nIG5o4bqlcCB2w6BvIHRow7RuZyBiw6FvIHRlc3QgY2jhu6ljIG7Eg25nIHRow7RuZyBiw6FvYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBH4butaSB0aMO0bmcgYsOhbyBs4buXaVxuICAgICAqL1xuICAgIG5vdGlmeUVycm9yKHRpdGxlLCBtZXNzYWdlKSB7XG4gICAgICAgIGxvZyhg8J+ToiBH4buNaSBub3RpZnlFcnJvciB24bubaSB0aXRsZTogJHt0aXRsZX0sIG1lc3NhZ2U6ICR7bWVzc2FnZX1gKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VuZE5vdGlmaWNhdGlvbih7XG4gICAgICAgICAgICB0aXRsZTogdGl0bGUgfHwgdGhpcy50KCdub3RpZmljYXRpb25zLmVycm9yLnRpdGxlJyksXG4gICAgICAgICAgICBib2R5OiBtZXNzYWdlIHx8IHRoaXMudCgnbm90aWZpY2F0aW9ucy5lcnJvci5kZWZhdWx0TWVzc2FnZScpLFxuICAgICAgICAgICAgdXJnZW5jeTogJ2NyaXRpY2FsJyxcbiAgICAgICAgICAgIHRpbWVvdXRUeXBlOiAnbmV2ZXInXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBMxrB1IHRow7RuZyBiw6FvIHbDoG8gbOG7i2NoIHPhu61cbiAgICAgKi9cbiAgICBhZGRUb0hpc3Rvcnkobm90aWZpY2F0aW9uKSB7XG4gICAgICAgIHRoaXMubm90aWZpY2F0aW9uSGlzdG9yeS51bnNoaWZ0KG5vdGlmaWNhdGlvbik7XG4gICAgICAgIFxuICAgICAgICAvLyBHaeG7m2kgaOG6oW4gbOG7i2NoIHPhu61cbiAgICAgICAgaWYgKHRoaXMubm90aWZpY2F0aW9uSGlzdG9yeS5sZW5ndGggPiB0aGlzLmhpc3RvcnlMaW1pdCkge1xuICAgICAgICAgICAgdGhpcy5ub3RpZmljYXRpb25IaXN0b3J5ID0gdGhpcy5ub3RpZmljYXRpb25IaXN0b3J5LnNsaWNlKDAsIHRoaXMuaGlzdG9yeUxpbWl0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBM4bqleSBs4buLY2ggc+G7rSB0aMO0bmcgYsOhb1xuICAgICAqL1xuICAgIGdldEhpc3RvcnkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5vdGlmaWNhdGlvbkhpc3Rvcnk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIELhuq10L3Thuq90IHRow7RuZyBiw6FvXG4gICAgICovXG4gICAgc2V0RW5hYmxlZChlbmFibGVkKSB7XG4gICAgICAgIHRoaXMuZW5hYmxlZCA9IGVuYWJsZWQ7XG4gICAgICAgIGxvZyhg8J+ToiBUaMO0bmcgYsOhbyDEkcOjIMSRxrDhu6NjICR7ZW5hYmxlZCA/ICdi4bqtdCcgOiAndOG6r3QnfWApO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBC4bqtdC904bqvdCDDom0gdGhhbmhcbiAgICAgKi9cbiAgICBzZXRTb3VuZEVuYWJsZWQoZW5hYmxlZCkge1xuICAgICAgICB0aGlzLnNvdW5kRW5hYmxlZCA9IGVuYWJsZWQ7XG4gICAgICAgIGxvZyhg8J+UiiDDgm0gdGhhbmggdGjDtG5nIGLDoW8gxJHDoyDEkcaw4bujYyAke2VuYWJsZWQgPyAnYuG6rXQnIDogJ3Thuq90J31gKTtcbiAgICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IE5vdGlmaWNhdGlvbk1hbmFnZXIoKTsgIiwiY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcblxuLy8gSW1wb3J0IG5ldyBtb2R1bGFyIHN0b3JhZ2Ugc3lzdGVtXG5jb25zdCBTdG9yYWdlTWFuYWdlciA9IHJlcXVpcmUoJy4vc3RvcmFnZS9zdG9yYWdlLW1hbmFnZXInKTtcblxuLyoqXG4gKiBTdG9yYWdlIEFkYXB0ZXIgxJHhu4MgZOG7hSBkw6BuZyBjaHV54buDbiDEkeG7lWkgZ2nhu69hIEpTT04gdsOgIFNRTGl0ZVxuICogVOG7sSDEkeG7mW5nIGRldGVjdCB2w6AgbWlncmF0ZSBu4bq/dSBj4bqnblxuICovXG5jbGFzcyBTdG9yYWdlQWRhcHRlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuc3RvcmFnZVR5cGUgPSAnc3FsaXRlJzsgLy8gQWx3YXlzIHVzZSBTUUxpdGVcbiAgICAgICAgdGhpcy5zdG9yYWdlID0gbnVsbDtcbiAgICAgICAgdGhpcy5pc0luaXRpYWxpemVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgYXN5bmMgaW5pdCgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5qAIEluaXRpYWxpemluZyBTdG9yYWdlIEFkYXB0ZXIuLi4nKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBTUUxpdGUgc3RvcmFnZSB24bubaSBtb2R1bGFyIHN5c3RlbVxuICAgICAgICAgICAgdGhpcy5zdG9yYWdlID0gbmV3IFN0b3JhZ2VNYW5hZ2VyKCk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnN0b3JhZ2UuaW5pdCgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDaOG6oXkgbWlncmF0aW9uIMSR4buDIMSR4bqjbSBi4bqjbyBzY2hlbWEgxJHDoyDEkcaw4bujYyBj4bqtcCBuaOG6rXRcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SEIENoZWNraW5nIGZvciBkYXRhYmFzZSBzY2hlbWEgbWlncmF0aW9ucy4uLicpO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnN0b3JhZ2UubWlncmF0ZVNjaGVtYSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc3RvcmFnZS5taWdyYXRlU2NoZW1hKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfimqDvuI8gbWlncmF0ZVNjaGVtYSBtZXRob2Qgbm90IGZvdW5kIGluIHN0b3JhZ2UgbWFuYWdlcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ+KchSBTdG9yYWdlIGFkYXB0ZXIgaW5pdGlhbGl6ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBpbml0aWFsaXplIHN0b3JhZ2UgYWRhcHRlcjonLCBlcnJvcik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIERlbGVnYXRlIHThuqV0IGPhuqMgbWV0aG9kcyB0byBzdG9yYWdlIG1hbmFnZXJcbiAgICBhc3luYyBnZXRBbGxGb2xkZXJzKHR5cGUpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmdldEFsbEZvbGRlcnModHlwZSk7XG4gICAgfVxuXG4gICAgYXN5bmMgY3JlYXRlRm9sZGVyKHR5cGUsIGZvbGRlckRhdGEpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmNyZWF0ZUZvbGRlcih0eXBlLCBmb2xkZXJEYXRhKTtcbiAgICB9XG5cbiAgICBhc3luYyB1cGRhdGVGb2xkZXIodHlwZSwgZm9sZGVySWQsIHVwZGF0ZXMpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLnVwZGF0ZUZvbGRlcih0eXBlLCBmb2xkZXJJZCwgdXBkYXRlcyk7XG4gICAgfVxuXG4gICAgYXN5bmMgZGVsZXRlRm9sZGVyKHR5cGUsIGZvbGRlcklkKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5kZWxldGVGb2xkZXIodHlwZSwgZm9sZGVySWQpO1xuICAgIH1cblxuICAgIGFzeW5jIGdldEFsbEFjY291bnRzKCkge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuZ2V0QWxsQWNjb3VudHMoKTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRBY2NvdW50c0J5Rm9sZGVyKGZvbGRlcklkKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5nZXRBY2NvdW50c0J5Rm9sZGVyKGZvbGRlcklkKTtcbiAgICB9XG5cbiAgICBhc3luYyBhZGRBY2NvdW50KGFjY291bnREYXRhKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5hZGRBY2NvdW50KGFjY291bnREYXRhKTtcbiAgICB9XG5cbiAgICBhc3luYyBkZWxldGVBY2NvdW50KGFjY291bnRJZCkge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuZGVsZXRlQWNjb3VudChhY2NvdW50SWQpO1xuICAgIH1cblxuICAgIGFzeW5jIHVwZGF0ZUFjY291bnQoaWQsIHVwZGF0ZXMpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLnVwZGF0ZUFjY291bnQoaWQsIHVwZGF0ZXMpO1xuICAgIH1cblxuICAgIGFzeW5jIHVwZGF0ZUFjY291bnRTdGF0cyhhY2NvdW50SWQsIHN0YXRzKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS51cGRhdGVBY2NvdW50U3RhdHMoYWNjb3VudElkLCBzdGF0cyk7XG4gICAgfVxuXG4gICAgYXN5bmMgYWRkQWNjb3VudFRvUm9vbShhY2NvdW50SWQsIHJvb21JZCkge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuYWRkQWNjb3VudFRvUm9vbShhY2NvdW50SWQsIHJvb21JZCk7XG4gICAgfVxuXG4gICAgYXN5bmMgcmVtb3ZlQWNjb3VudEZyb21Sb29tKGFjY291bnRJZCwgcm9vbUlkKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5yZW1vdmVBY2NvdW50RnJvbVJvb20oYWNjb3VudElkLCByb29tSWQpO1xuICAgIH1cblxuICAgIGFzeW5jIHJlbGVhc2VBY2NvdW50c0Zyb21Sb29tKHJvb21JZCkge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIC8vIEtp4buDbSB0cmEgeGVtIHN0b3JhZ2Uucm9vbVN0b3JhZ2UgY8OzIHThu5NuIHThuqFpIGtow7RuZ1xuICAgICAgICBpZiAodGhpcy5zdG9yYWdlICYmIHRoaXMuc3RvcmFnZS5yb29tU3RvcmFnZSAmJiBcbiAgICAgICAgICAgIHR5cGVvZiB0aGlzLnN0b3JhZ2Uucm9vbVN0b3JhZ2UucmVsZWFzZUFjY291bnRzRnJvbVJvb20gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2Uucm9vbVN0b3JhZ2UucmVsZWFzZUFjY291bnRzRnJvbVJvb20ocm9vbUlkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBDYW5ub3QgcmVsZWFzZSBhY2NvdW50czogc3RvcmFnZS5yb29tU3RvcmFnZSBub3QgYXZhaWxhYmxlJyk7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdzdG9yYWdlLnJvb21TdG9yYWdlIG5vdCBhdmFpbGFibGUnIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBjbGVhckFjY291bnRSb29tcyhhY2NvdW50SWQpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmNsZWFyQWNjb3VudFJvb21zKGFjY291bnRJZCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0QWNjb3VudEFjdGl2ZVJvb21zKGFjY291bnRJZCkge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuZ2V0QWNjb3VudEFjdGl2ZVJvb21zKGFjY291bnRJZCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0QWNjb3VudHNJblJvb20ocm9vbUlkKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5nZXRBY2NvdW50c0luUm9vbShyb29tSWQpO1xuICAgIH1cblxuICAgIGFzeW5jIGdldEFsbFByb3hpZXMoKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5nZXRBbGxQcm94aWVzKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0UHJveGllc0J5Rm9sZGVyKGZvbGRlcklkKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5nZXRQcm94aWVzQnlGb2xkZXIoZm9sZGVySWQpO1xuICAgIH1cblxuICAgIGFzeW5jIGFkZFByb3h5KHByb3h5RGF0YSkge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuYWRkUHJveHkocHJveHlEYXRhKTtcbiAgICB9XG5cbiAgICBhc3luYyBkZWxldGVQcm94eShwcm94eUlkKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5kZWxldGVQcm94eShwcm94eUlkKTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRQcm94eUJ5SWQocHJveHlJZCkge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuZ2V0UHJveHlCeUlkKHByb3h5SWQpO1xuICAgIH1cblxuICAgIGFzeW5jIHVwZGF0ZVByb3h5KHByb3h5SWQsIHVwZGF0ZXMpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLnVwZGF0ZVByb3h5KHByb3h5SWQsIHVwZGF0ZXMpO1xuICAgIH1cblxuICAgIGFzeW5jIHRlc3RQcm94eShwcm94eUlkKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS50ZXN0UHJveHkocHJveHlJZCk7XG4gICAgfVxuXG4gICAgYXN5bmMgaW1wb3J0UHJveGllc0Zyb21UZXh0KHRleHQsIGZvbGRlcklkID0gbnVsbCkge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuaW1wb3J0UHJveGllc0Zyb21UZXh0KHRleHQsIGZvbGRlcklkKTtcbiAgICB9XG5cbiAgICBhc3luYyBidWxrTW92ZVByb3hpZXNUb0ZvbGRlcihwcm94eUlkcywgZm9sZGVySWQpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmJ1bGtNb3ZlUHJveGllc1RvRm9sZGVyKHByb3h5SWRzLCBmb2xkZXJJZCk7XG4gICAgfVxuICAgIFxuICAgIGFzeW5jIGJ1bGtUZXN0UHJveGllcyhwcm94eUlkcykge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuYnVsa1Rlc3RQcm94aWVzKHByb3h5SWRzKTtcbiAgICB9XG4gICAgXG4gICAgYXN5bmMgZXhwb3J0UHJveGllcyhmb3JtYXQgPSAnaXBfcG9ydF91c2VybmFtZV9wYXNzd29yZCcsIHByb3h5SWRzID0gbnVsbCkge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuZXhwb3J0UHJveGllcyhmb3JtYXQsIHByb3h5SWRzKTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRBbGxSb29tcygpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmdldEFsbFJvb21zKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgYWRkUm9vbShyb29tRGF0YSkge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuYWRkUm9vbShyb29tRGF0YSk7XG4gICAgfVxuXG4gICAgYXN5bmMgdXBkYXRlUm9vbShyb29tVWlkLCB1cGRhdGVzKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS51cGRhdGVSb29tKHJvb21VaWQsIHVwZGF0ZXMpO1xuICAgIH1cblxuICAgIGFzeW5jIGRlbGV0ZVJvb20ocm9vbVVpZCkge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuZGVsZXRlUm9vbShyb29tVWlkKTtcbiAgICB9XG5cbiAgICBhc3luYyBjbGVhckFsbEFjY291bnRSb29tcygpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmNsZWFyQWxsQWNjb3VudFJvb21zKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgYWRkVmlld2VySGlzdG9yeUVudHJ5KHJvb21VaWQsIHZpZXdlckRhdGEpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmFkZFZpZXdlckhpc3RvcnlFbnRyeShyb29tVWlkLCB2aWV3ZXJEYXRhKTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRSb29tVmlld2VySGlzdG9yeShyb29tVWlkLCBkYXlzID0gbnVsbCkge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuZ2V0Um9vbVZpZXdlckhpc3Rvcnkocm9vbVVpZCwgZGF5cyk7XG4gICAgfVxuXG4gICAgYXN5bmMgY2xlYW51cFZpZXdlckhpc3RvcnlGaWxlcygpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmNsZWFudXBWaWV3ZXJIaXN0b3J5RmlsZXMoKTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRTZXR0aW5ncygpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmdldFNldHRpbmdzKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKHNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5zYXZlU2V0dGluZ3Moc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIGFzeW5jIHJlc2V0U2V0dGluZ3MoKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5yZXNldFNldHRpbmdzKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0QWxsVGFza3MoKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5nZXRBbGxUYXNrcygpO1xuICAgIH1cblxuICAgIGFzeW5jIGFkZFRhc2sodGFza0RhdGEpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmFkZFRhc2sodGFza0RhdGEpO1xuICAgIH1cblxuICAgIGFzeW5jIHVwZGF0ZVRhc2sodGFza0lkLCB1cGRhdGVzKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS51cGRhdGVUYXNrKHRhc2tJZCwgdXBkYXRlcyk7XG4gICAgfVxuXG4gICAgYXN5bmMgZGVsZXRlVGFzayh0YXNrSWQpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmRlbGV0ZVRhc2sodGFza0lkKTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRUYXNrQnlJZCh0YXNrSWQpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmdldFRhc2tCeUlkKHRhc2tJZCk7XG4gICAgfVxuXG4gICAgYXN5bmMgaW1wb3J0QWNjb3VudHNGcm9tVGV4dCh0ZXh0LCBmb2xkZXJJZCA9IG51bGwpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmltcG9ydEFjY291bnRzRnJvbVRleHQodGV4dCwgZm9sZGVySWQpO1xuICAgIH1cblxuICAgIC8vIEFjY291bnQgYnVsayBvcGVyYXRpb25zXG4gICAgYXN5bmMgYnVsa1NldFByb3h5KGFjY291bnRJZHMsIHByb3h5Rm9sZGVySWQsIGFjY291bnRzUGVyUHJveHkgPSAxLCBzZWxlY3RlZFByb3hpZXMgPSBudWxsKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5idWxrU2V0UHJveHkoYWNjb3VudElkcywgcHJveHlGb2xkZXJJZCwgYWNjb3VudHNQZXJQcm94eSwgc2VsZWN0ZWRQcm94aWVzKTtcbiAgICB9XG4gICAgXG4gICAgYXN5bmMgYnVsa1JlbW92ZVByb3h5KGFjY291bnRJZHMpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmJ1bGtSZW1vdmVQcm94eShhY2NvdW50SWRzKTtcbiAgICB9XG4gICAgXG4gICAgYXN5bmMgYnVsa1NldFN0YXR1cyhhY2NvdW50SWRzLCBzdGF0dXMpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmJ1bGtTZXRTdGF0dXMoYWNjb3VudElkcywgc3RhdHVzKTtcbiAgICB9XG4gICAgXG4gICAgYXN5bmMgYnVsa01vdmVUb0ZvbGRlcihhY2NvdW50SWRzLCBmb2xkZXJJZCkge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuYnVsa01vdmVUb0ZvbGRlcihhY2NvdW50SWRzLCBmb2xkZXJJZCk7XG4gICAgfVxuICAgIFxuICAgIGFzeW5jIGV4cG9ydEFjY291bnRzVG9UZXh0KGZvcm1hdCwgYWNjb3VudElkcywgZm9sZGVySWQpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmV4cG9ydEFjY291bnRzVG9UZXh0KGZvcm1hdCwgYWNjb3VudElkcywgZm9sZGVySWQpO1xuICAgIH1cblxuICAgIC8vIFV0aWxpdHkgbWV0aG9kc1xuICAgIGNsb3NlKCkge1xuICAgICAgICBpZiAodGhpcy5zdG9yYWdlICYmIHRoaXMuc3RvcmFnZS5jbG9zZSkge1xuICAgICAgICAgICAgdGhpcy5zdG9yYWdlLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc0luaXRpYWxpemVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgZW5zdXJlSW5pdGlhbGl6ZWQoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0luaXRpYWxpemVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N0b3JhZ2UgYWRhcHRlciBub3QgaW5pdGlhbGl6ZWQuIENhbGwgaW5pdCgpIGZpcnN0LicpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0U3RvcmFnZVR5cGUoKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5nZXRTdG9yYWdlVHlwZSgpO1xuICAgIH1cblxuICAgIGlzVXNpbmdTUUxpdGUoKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZS5pc1VzaW5nU1FMaXRlKCk7XG4gICAgfVxuXG4gICAgZ2V0RGF0YWJhc2VJbmZvKCkge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIGlmICh0aGlzLnN0b3JhZ2UuZ2V0RGF0YWJhc2VJbmZvKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmdldERhdGFiYXNlSW5mbygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvcmNlIG1pZ3JhdGUgdOG7qyBKU09OIHNhbmcgU1FMaXRlXG4gICAgICovXG4gICAgYXN5bmMgZm9yY2VNaWdyYXRpb25Ub1NRTGl0ZSgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SEIEZvcmNlIG1pZ3JhdGlvbiB04burIEpTT04gc2FuZyBTUUxpdGUuLi4nKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgbWlncmF0aW9uID0gbmV3IERhdGFNaWdyYXRpb24oKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1pZ3JhdGlvbi5ydW4oKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgLy8gQ2h1eeG7g24gc2FuZyBTUUxpdGUgc3RvcmFnZVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0b3JhZ2UgJiYgdHlwZW9mIHRoaXMuc3RvcmFnZS5jbG9zZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3JhZ2UuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGhpcy5zdG9yYWdlID0gbmV3IFNRTGl0ZVN0b3JhZ2VNYW5hZ2VyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zdG9yYWdlVHlwZSA9ICdzcWxpdGUnO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgRm9yY2UgbWlncmF0aW9uIHRow6BuaCBjw7RuZycpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHJlc3VsdHM6IHJlc3VsdC5yZXN1bHRzIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGb3JjZSBtaWdyYXRpb24gdGjhuqV0IGLhuqFpOicsIHJlc3VsdC5lcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiByZXN1bHQuZXJyb3IgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEzhu5dpIGZvcmNlIG1pZ3JhdGlvbjonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBSb2xsYmFjayB24buBIEpTT04gc3RvcmFnZVxuICAgICAqL1xuICAgIGFzeW5jIHJvbGxiYWNrVG9KU09OKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ/CflIQgUm9sbGJhY2sgduG7gSBKU09OIHN0b3JhZ2UuLi4nKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgbWlncmF0aW9uID0gbmV3IERhdGFNaWdyYXRpb24oKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1pZ3JhdGlvbi5yb2xsYmFjaygpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAvLyBDaHV54buDbiB24buBIEpTT04gc3RvcmFnZVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0b3JhZ2UgJiYgdHlwZW9mIHRoaXMuc3RvcmFnZS5jbG9zZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3JhZ2UuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGhpcy5zdG9yYWdlID0gbmV3IFN0b3JhZ2VNYW5hZ2VyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zdG9yYWdlVHlwZSA9ICdqc29uJztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIFJvbGxiYWNrIHRow6BuaCBjw7RuZycpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFJvbGxiYWNrIHRo4bqldCBi4bqhaTonLCByZXN1bHQuZXJyb3IpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogcmVzdWx0LmVycm9yIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBM4buXaSByb2xsYmFjazonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBIZWxwZXIgbWV0aG9kcyAobuG6v3UgY8OzIHRyb25nIGPhuqMgMiBzdG9yYWdlKVxuICAgIGV4dHJhY3RVc2VybmFtZShhY2NvdW50SW5mbykge1xuICAgICAgICB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UuZXh0cmFjdFVzZXJuYW1lKGFjY291bnRJbmZvKTtcbiAgICB9XG4gICAgXG4gICAgZXh0cmFjdFByb3h5SG9zdChwcm94eUluZm8pIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yYWdlLmV4dHJhY3RQcm94eUhvc3QocHJveHlJbmZvKTtcbiAgICB9XG59XG5cbi8vIEV4cG9ydCBjbGFzcyBpbnN0ZWFkIG9mIHNpbmdsZXRvblxubW9kdWxlLmV4cG9ydHMgPSBTdG9yYWdlQWRhcHRlcjsgIiwiY29uc3QgQmFzZVN0b3JhZ2UgPSByZXF1aXJlKCcuL2Jhc2Utc3RvcmFnZScpO1xuY29uc3QgeyBsb2csIGVycm9yIH0gPSByZXF1aXJlKCcuLi9sb2dnZXInKTtcblxuY2xhc3MgQWNjb3VudFN0b3JhZ2UgZXh0ZW5kcyBCYXNlU3RvcmFnZSB7XG4gICAgLyoqXG4gICAgICogTOG6pXkgdOG6pXQgY+G6oyBhY2NvdW50c1xuICAgICAqL1xuICAgIGFzeW5jIGdldEFsbEFjY291bnRzKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbG9nKCfwn5SEIEfhu41pIGdldEFsbEFjY291bnRzJyk7XG4gICAgICAgICAgICBjb25zdCBzdG10ID0gdGhpcy5kYi5wcmVwYXJlKGBcbiAgICAgICAgICAgICAgICBTRUxFQ1QgYS4qLCBmLm5hbWUgYXMgZm9sZGVyTmFtZSwgZi5jb2xvciBhcyBmb2xkZXJDb2xvclxuICAgICAgICAgICAgICAgIEZST00gYWNjb3VudHMgYVxuICAgICAgICAgICAgICAgIExFRlQgSk9JTiBmb2xkZXJzIGYgT04gYS5mb2xkZXJJZCA9IGYuaWRcbiAgICAgICAgICAgICAgICBPUkRFUiBCWSBhLnVzZXJuYW1lIEFTQ1xuICAgICAgICAgICAgYCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGFjY291bnRzID0gc3RtdC5hbGwoKTtcbiAgICAgICAgICAgIGxvZyhg8J+TiiDEkOG7jWMgxJHGsOG7o2MgJHthY2NvdW50cy5sZW5ndGh9IHTDoGkga2hv4bqjbiB04burIGRhdGFiYXNlYCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFjhu60gbMO9IGThu68gbGnhu4d1IHRy4bqjIHbhu4FcbiAgICAgICAgICAgIGNvbnN0IHByb2Nlc3NlZEFjY291bnRzID0gYWNjb3VudHMubWFwKGFjY291bnQgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFBhcnNlIGFjdGl2ZVJvb21zIHThu6sgSlNPTiBzdHJpbmdcbiAgICAgICAgICAgICAgICBsZXQgYWN0aXZlUm9vbXMgPSBbXTtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWNjb3VudC5hY3RpdmVSb29tcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlUm9vbXMgPSBKU09OLnBhcnNlKGFjY291bnQuYWN0aXZlUm9vbXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICBlcnJvcign4p2MIEzhu5dpIHBhcnNlIGFjdGl2ZVJvb21zOicsIGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBY4butIGzDvSBtZXRhZGF0YVxuICAgICAgICAgICAgICAgIGxldCBtZXRhZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhY2NvdW50Lm1ldGFkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YSA9IEpTT04ucGFyc2UoYWNjb3VudC5tZXRhZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yKCfinYwgTOG7l2kgcGFyc2UgbWV0YWRhdGE6JywgZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLmFjY291bnQsXG4gICAgICAgICAgICAgICAgICAgIC8vIENvbnZlcnQgQm9vbGVhbiB2YWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgaXNMaXZlOiBCb29sZWFuKGFjY291bnQuaXNMaXZlKSxcbiAgICAgICAgICAgICAgICAgICAgLy8gUGFyc2UgSlNPTiBmaWVsZHNcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlUm9vbXM6IGFjdGl2ZVJvb21zLFxuICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YTogbWV0YWRhdGEsXG4gICAgICAgICAgICAgICAgICAgIC8vIEtlZXAgSVNPIGRhdGUgc3RyaW5nc1xuICAgICAgICAgICAgICAgICAgICBsYXN0QWN0aXZlOiBhY2NvdW50Lmxhc3RBY3RpdmUsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogYWNjb3VudC5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDogYWNjb3VudC51cGRhdGVkQXRcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxvZyhg4pyFIMSQw6MgeOG7rSBsw70gJHtwcm9jZXNzZWRBY2NvdW50cy5sZW5ndGh9IHTDoGkga2hv4bqjbiwgdHLhuqMgduG7gSBjaG8gVUlgKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlcmlhbGl6ZUZvcklQQyhwcm9jZXNzZWRBY2Nvd